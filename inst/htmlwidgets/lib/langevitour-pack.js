var langevitour;(()=>{var t={162:function(t){var n;t.exports=(n=function(t,n){var e=Array.prototype.concat,r=Array.prototype.slice,i=Object.prototype.toString;function a(n,e){var r=n>e?n:e;return t.pow(10,17-~~(t.log(r>0?r:-r)*t.LOG10E))}var o=Array.isArray||function(t){return"[object Array]"===i.call(t)};function u(t){return"[object Function]"===i.call(t)}function l(t){return"number"==typeof t&&t-t==0}function s(){return new s._init(arguments)}function f(){return 0}function c(){return 1}function h(t,n){return t===n?1:0}s.fn=s.prototype,s._init=function(t){if(o(t[0]))if(o(t[0][0])){u(t[1])&&(t[0]=s.map(t[0],t[1]));for(var n=0;n<t[0].length;n++)this[n]=t[0][n];this.length=t[0].length}else this[0]=u(t[1])?s.map(t[0],t[1]):t[0],this.length=1;else if(l(t[0]))this[0]=s.seq.apply(null,t),this.length=1;else{if(t[0]instanceof s)return s(t[0].toArray());this[0]=[],this.length=1}return this},s._init.prototype=s.prototype,s._init.constructor=s,s.utils={calcRdx:a,isArray:o,isFunction:u,isNumber:l,toVector:function(t){return e.apply([],t)}},s._random_fn=t.random,s.setRandom=function(t){if("function"!=typeof t)throw new TypeError("fn is not a function");s._random_fn=t},s.extend=function(t){var n,e;if(1===arguments.length){for(e in t)s[e]=t[e];return this}for(n=1;n<arguments.length;n++)for(e in arguments[n])t[e]=arguments[n][e];return t},s.rows=function(t){return t.length||1},s.cols=function(t){return t[0].length||1},s.dimensions=function(t){return{rows:s.rows(t),cols:s.cols(t)}},s.row=function(t,n){return o(n)?n.map((function(n){return s.row(t,n)})):t[n]},s.rowa=function(t,n){return s.row(t,n)},s.col=function(t,n){if(o(n)){var e=s.arange(t.length).map((function(){return new Array(n.length)}));return n.forEach((function(n,r){s.arange(t.length).forEach((function(i){e[i][r]=t[i][n]}))})),e}for(var r=new Array(t.length),i=0;i<t.length;i++)r[i]=[t[i][n]];return r},s.cola=function(t,n){return s.col(t,n).map((function(t){return t[0]}))},s.diag=function(t){for(var n=s.rows(t),e=new Array(n),r=0;r<n;r++)e[r]=[t[r][r]];return e},s.antidiag=function(t){for(var n=s.rows(t)-1,e=new Array(n),r=0;n>=0;n--,r++)e[r]=[t[r][n]];return e},s.transpose=function(t){var n,e,r,i,a,u=[];for(o(t[0])||(t=[t]),e=t.length,r=t[0].length,a=0;a<r;a++){for(n=new Array(e),i=0;i<e;i++)n[i]=t[i][a];u.push(n)}return 1===u.length?u[0]:u},s.map=function(t,n,e){var r,i,a,u,l;for(o(t[0])||(t=[t]),i=t.length,a=t[0].length,u=e?t:new Array(i),r=0;r<i;r++)for(u[r]||(u[r]=new Array(a)),l=0;l<a;l++)u[r][l]=n(t[r][l],r,l);return 1===u.length?u[0]:u},s.cumreduce=function(t,n,e){var r,i,a,u,l;for(o(t[0])||(t=[t]),i=t.length,a=t[0].length,u=e?t:new Array(i),r=0;r<i;r++)for(u[r]||(u[r]=new Array(a)),a>0&&(u[r][0]=t[r][0]),l=1;l<a;l++)u[r][l]=n(u[r][l-1],t[r][l]);return 1===u.length?u[0]:u},s.alter=function(t,n){return s.map(t,n,!0)},s.create=function(t,n,e){var r,i,a=new Array(t);for(u(n)&&(e=n,n=t),r=0;r<t;r++)for(a[r]=new Array(n),i=0;i<n;i++)a[r][i]=e(r,i);return a},s.zeros=function(t,n){return l(n)||(n=t),s.create(t,n,f)},s.ones=function(t,n){return l(n)||(n=t),s.create(t,n,c)},s.rand=function(t,n){return l(n)||(n=t),s.create(t,n,s._random_fn)},s.identity=function(t,n){return l(n)||(n=t),s.create(t,n,h)},s.symmetric=function(t){var n,e,r=t.length;if(t.length!==t[0].length)return!1;for(n=0;n<r;n++)for(e=0;e<r;e++)if(t[e][n]!==t[n][e])return!1;return!0},s.clear=function(t){return s.alter(t,f)},s.seq=function(t,n,e,r){u(r)||(r=!1);var i,o=[],l=a(t,n),s=(n*l-t*l)/((e-1)*l),f=t;for(i=0;f<=n&&i<e;f=(t*l+s*l*++i)/l)o.push(r?r(f,i):f);return o},s.arange=function(t,e,r){var i,a=[];if(r=r||1,e===n&&(e=t,t=0),t===e||0===r)return[];if(t<e&&r<0)return[];if(t>e&&r>0)return[];if(r>0)for(i=t;i<e;i+=r)a.push(i);else for(i=t;i>e;i+=r)a.push(i);return a},s.slice=function(){function t(t,e,r,i){var a,o=[],u=t.length;if(e===n&&r===n&&i===n)return s.copy(t);if(i=i||1,(e=(e=e||0)>=0?e:u+e)===(r=(r=r||t.length)>=0?r:u+r)||0===i)return[];if(e<r&&i<0)return[];if(e>r&&i>0)return[];if(i>0)for(a=e;a<r;a+=i)o.push(t[a]);else for(a=e;a>r;a+=i)o.push(t[a]);return o}return function(n,e){var r,i;return l((e=e||{}).row)?l(e.col)?n[e.row][e.col]:t(s.rowa(n,e.row),(r=e.col||{}).start,r.end,r.step):l(e.col)?t(s.cola(n,e.col),(i=e.row||{}).start,i.end,i.step):(i=e.row||{},r=e.col||{},t(n,i.start,i.end,i.step).map((function(n){return t(n,r.start,r.end,r.step)})))}}(),s.sliceAssign=function(e,r,i){var a,o;if(l(r.row)){if(l(r.col))return e[r.row][r.col]=i;r.col=r.col||{},r.col.start=r.col.start||0,r.col.end=r.col.end||e[0].length,r.col.step=r.col.step||1,a=s.arange(r.col.start,t.min(e.length,r.col.end),r.col.step);var u=r.row;return a.forEach((function(t,n){e[u][t]=i[n]})),e}if(l(r.col)){r.row=r.row||{},r.row.start=r.row.start||0,r.row.end=r.row.end||e.length,r.row.step=r.row.step||1,o=s.arange(r.row.start,t.min(e[0].length,r.row.end),r.row.step);var f=r.col;return o.forEach((function(t,n){e[t][f]=i[n]})),e}return i[0].length===n&&(i=[i]),r.row.start=r.row.start||0,r.row.end=r.row.end||e.length,r.row.step=r.row.step||1,r.col.start=r.col.start||0,r.col.end=r.col.end||e[0].length,r.col.step=r.col.step||1,o=s.arange(r.row.start,t.min(e.length,r.row.end),r.row.step),a=s.arange(r.col.start,t.min(e[0].length,r.col.end),r.col.step),o.forEach((function(t,n){a.forEach((function(r,a){e[t][r]=i[n][a]}))})),e},s.diagonal=function(t){var n=s.zeros(t.length,t.length);return t.forEach((function(t,e){n[e][e]=t})),n},s.copy=function(t){return t.map((function(t){return l(t)?t:t.map((function(t){return t}))}))};var d=s.prototype;return d.length=0,d.push=Array.prototype.push,d.sort=Array.prototype.sort,d.splice=Array.prototype.splice,d.slice=Array.prototype.slice,d.toArray=function(){return this.length>1?r.call(this):r.call(this)[0]},d.map=function(t,n){return s(s.map(this,t,n))},d.cumreduce=function(t,n){return s(s.cumreduce(this,t,n))},d.alter=function(t){return s.alter(this,t),this},function(t){for(var n=0;n<t.length;n++)!function(t){d[t]=function(n){var e,r=this;return n?(setTimeout((function(){n.call(r,d[t].call(r))})),this):(e=s[t](this),o(e)?s(e):e)}}(t[n])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){d[t]=function(n,e){var r=this;return e?(setTimeout((function(){e.call(r,d[t].call(r,n))})),this):s(s[t](this,n))}}(t[n])}("row col".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){d[t]=function(){return s(s[t].apply(null,arguments))}}(t[n])}("create zeros ones rand identity".split(" ")),s}(Math),function(t,n){var e=t.utils.isFunction;function r(t,n){return t-n}function i(t,e,r){return n.max(e,n.min(t,r))}t.sum=function(t){for(var n=0,e=t.length;--e>=0;)n+=t[e];return n},t.sumsqrd=function(t){for(var n=0,e=t.length;--e>=0;)n+=t[e]*t[e];return n},t.sumsqerr=function(n){for(var e,r=t.mean(n),i=0,a=n.length;--a>=0;)i+=(e=n[a]-r)*e;return i},t.sumrow=function(t){for(var n=0,e=t.length;--e>=0;)n+=t[e];return n},t.product=function(t){for(var n=1,e=t.length;--e>=0;)n*=t[e];return n},t.min=function(t){for(var n=t[0],e=0;++e<t.length;)t[e]<n&&(n=t[e]);return n},t.max=function(t){for(var n=t[0],e=0;++e<t.length;)t[e]>n&&(n=t[e]);return n},t.unique=function(t){for(var n={},e=[],r=0;r<t.length;r++)n[t[r]]||(n[t[r]]=!0,e.push(t[r]));return e},t.mean=function(n){return t.sum(n)/n.length},t.meansqerr=function(n){return t.sumsqerr(n)/n.length},t.geomean=function(e){return n.pow(t.product(e),1/e.length)},t.median=function(t){var n=t.length,e=t.slice().sort(r);return 1&n?e[n/2|0]:(e[n/2-1]+e[n/2])/2},t.cumsum=function(n){return t.cumreduce(n,(function(t,n){return t+n}))},t.cumprod=function(n){return t.cumreduce(n,(function(t,n){return t*n}))},t.diff=function(t){var n,e=[],r=t.length;for(n=1;n<r;n++)e.push(t[n]-t[n-1]);return e},t.rank=function(t){var n,e=[],i={};for(n=0;n<t.length;n++)i[l=t[n]]?i[l]++:(i[l]=1,e.push(l));var a=e.sort(r),o={},u=1;for(n=0;n<a.length;n++){var l,s=i[l=a[n]],f=(u+(u+s-1))/2;o[l]=f,u+=s}return t.map((function(t){return o[t]}))},t.mode=function(t){var n,e=t.length,i=t.slice().sort(r),a=1,o=0,u=0,l=[];for(n=0;n<e;n++)i[n]===i[n+1]?a++:(a>o?(l=[i[n]],o=a,u=0):a===o&&(l.push(i[n]),u++),a=1);return 0===u?l[0]:l},t.range=function(n){return t.max(n)-t.min(n)},t.variance=function(n,e){return t.sumsqerr(n)/(n.length-(e?1:0))},t.pooledvariance=function(n){return n.reduce((function(n,e){return n+t.sumsqerr(e)}),0)/(n.reduce((function(t,n){return t+n.length}),0)-n.length)},t.deviation=function(n){for(var e=t.mean(n),r=n.length,i=new Array(r),a=0;a<r;a++)i[a]=n[a]-e;return i},t.stdev=function(e,r){return n.sqrt(t.variance(e,r))},t.pooledstdev=function(e){return n.sqrt(t.pooledvariance(e))},t.meandev=function(e){for(var r=t.mean(e),i=[],a=e.length-1;a>=0;a--)i.push(n.abs(e[a]-r));return t.mean(i)},t.meddev=function(e){for(var r=t.median(e),i=[],a=e.length-1;a>=0;a--)i.push(n.abs(e[a]-r));return t.median(i)},t.coeffvar=function(n){return t.stdev(n)/t.mean(n)},t.quartiles=function(t){var e=t.length,i=t.slice().sort(r);return[i[n.round(e/4)-1],i[n.round(e/2)-1],i[n.round(3*e/4)-1]]},t.quantiles=function(t,e,a,o){var u,l,s,f,c,h=t.slice().sort(r),d=[e.length],p=t.length;for(void 0===a&&(a=3/8),void 0===o&&(o=3/8),u=0;u<e.length;u++)s=p*(l=e[u])+(a+l*(1-a-o)),f=n.floor(i(s,1,p-1)),c=i(s-f,0,1),d[u]=(1-c)*h[f-1]+c*h[f];return d},t.percentile=function(t,n,e){var i=t.slice().sort(r),a=n*(i.length+(e?1:-1))+(e?0:1),o=parseInt(a),u=a-o;return o+1<i.length?i[o-1]+u*(i[o]-i[o-1]):i[o-1]},t.percentileOfScore=function(t,n,e){var r,i,a=0,o=t.length,u=!1;for("strict"===e&&(u=!0),i=0;i<o;i++)r=t[i],(u&&r<n||!u&&r<=n)&&a++;return a/o},t.histogram=function(e,r){r=r||4;var i,a=t.min(e),o=(t.max(e)-a)/r,u=e.length,l=[];for(i=0;i<r;i++)l[i]=0;for(i=0;i<u;i++)l[n.min(n.floor((e[i]-a)/o),r-1)]+=1;return l},t.covariance=function(n,e){var r,i=t.mean(n),a=t.mean(e),o=n.length,u=new Array(o);for(r=0;r<o;r++)u[r]=(n[r]-i)*(e[r]-a);return t.sum(u)/(o-1)},t.corrcoeff=function(n,e){return t.covariance(n,e)/t.stdev(n,1)/t.stdev(e,1)},t.spearmancoeff=function(n,e){return n=t.rank(n),e=t.rank(e),t.corrcoeff(n,e)},t.stanMoment=function(e,r){for(var i=t.mean(e),a=t.stdev(e),o=e.length,u=0,l=0;l<o;l++)u+=n.pow((e[l]-i)/a,r);return u/e.length},t.skewness=function(n){return t.stanMoment(n,3)},t.kurtosis=function(n){return t.stanMoment(n,4)-3};var a=t.prototype;!function(n){for(var r=0;r<n.length;r++)!function(n){a[n]=function(r,i){var o=[],u=0,l=this;if(e(r)&&(i=r,r=!1),i)return setTimeout((function(){i.call(l,a[n].call(l,r))})),this;if(this.length>1){for(l=!0===r?this:this.transpose();u<l.length;u++)o[u]=t[n](l[u]);return o}return t[n](this[0],r)}}(n[r])}("cumsum cumprod".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){a[n]=function(r,i){var o=[],u=0,l=this;if(e(r)&&(i=r,r=!1),i)return setTimeout((function(){i.call(l,a[n].call(l,r))})),this;if(this.length>1){for("sumrow"!==n&&(l=!0===r?this:this.transpose());u<l.length;u++)o[u]=t[n](l[u]);return!0===r?t[n](t.utils.toVector(o)):o}return t[n](this[0],r)}}(n[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){a[n]=function(){var r,i=[],o=0,u=this,l=Array.prototype.slice.call(arguments);if(e(l[l.length-1])){r=l[l.length-1];var s=l.slice(0,l.length-1);return setTimeout((function(){r.call(u,a[n].apply(u,s))})),this}r=void 0;var f=function(e){return t[n].apply(u,[e].concat(l))};if(this.length>1){for(u=u.transpose();o<u.length;o++)i[o]=f(u[o]);return i}return f(this[0])}}(n[r])}("quantiles percentileOfScore".split(" "))}(n,Math),function(t,n){t.gammaln=function(t){var e,r,i,a=0,o=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],u=1.000000000190015;for(i=(r=e=t)+5.5,i-=(e+.5)*n.log(i);a<6;a++)u+=o[a]/++r;return n.log(2.5066282746310007*u/e)-i},t.loggam=function(t){var e,r,i,a,o,u,l,s=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(e=t,l=0,1==t||2==t)return 0;for(t<=7&&(e=t+(l=n.floor(7-t))),r=1/(e*e),i=2*n.PI,o=s[9],u=8;u>=0;u--)o*=r,o+=s[u];if(a=o/e+.5*n.log(i)+(e-.5)*n.log(e)-e,t<=7)for(u=1;u<=l;u++)a-=n.log(e-1),e-=1;return a},t.gammafn=function(t){var e,r,i,a,o=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],u=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,s=0,f=0,c=0,h=t;if(t>171.6243769536076)return 1/0;if(h<=0){if(!(a=h%1+36e-17))return 1/0;l=(1&h?-1:1)*n.PI/n.sin(n.PI*a),h=1-h}for(i=h,r=h<1?h++:(h-=s=(0|h)-1)-1,e=0;e<8;++e)c=(c+o[e])*r,f=f*r+u[e];if(a=c/f+1,i<h)a/=i;else if(i>h)for(e=0;e<s;++e)a*=h,h++;return l&&(a=l/a),a},t.gammap=function(n,e){return t.lowRegGamma(n,e)*t.gammafn(n)},t.lowRegGamma=function(e,r){var i,a=t.gammaln(e),o=e,u=1/e,l=u,s=r+1-e,f=1/1e-30,c=1/s,h=c,d=1,p=-~(8.5*n.log(e>=1?e:1/e)+.4*e+17);if(r<0||e<=0)return NaN;if(r<e+1){for(;d<=p;d++)u+=l*=r/++o;return u*n.exp(-r+e*n.log(r)-a)}for(;d<=p;d++)h*=(c=1/(c=(i=-d*(d-e))*c+(s+=2)))*(f=s+i/f);return 1-h*n.exp(-r+e*n.log(r)-a)},t.factorialln=function(n){return n<0?NaN:t.gammaln(n+1)},t.factorial=function(n){return n<0?NaN:t.gammafn(n+1)},t.combination=function(e,r){return e>170||r>170?n.exp(t.combinationln(e,r)):t.factorial(e)/t.factorial(r)/t.factorial(e-r)},t.combinationln=function(n,e){return t.factorialln(n)-t.factorialln(e)-t.factorialln(n-e)},t.permutation=function(n,e){return t.factorial(n)/t.factorial(n-e)},t.betafn=function(e,r){if(!(e<=0||r<=0))return e+r>170?n.exp(t.betaln(e,r)):t.gammafn(e)*t.gammafn(r)/t.gammafn(e+r)},t.betaln=function(n,e){return t.gammaln(n)+t.gammaln(e)-t.gammaln(n+e)},t.betacf=function(t,e,r){var i,a,o,u,l=1e-30,s=1,f=e+r,c=e+1,h=e-1,d=1,p=1-f*t/c;for(n.abs(p)<l&&(p=l),u=p=1/p;s<=100&&(p=1+(a=s*(r-s)*t/((h+(i=2*s))*(e+i)))*p,n.abs(p)<l&&(p=l),d=1+a/d,n.abs(d)<l&&(d=l),u*=(p=1/p)*d,p=1+(a=-(e+s)*(f+s)*t/((e+i)*(c+i)))*p,n.abs(p)<l&&(p=l),d=1+a/d,n.abs(d)<l&&(d=l),u*=o=(p=1/p)*d,!(n.abs(o-1)<3e-7));s++);return u},t.gammapinv=function(e,r){var i,a,o,u,l,s,f=0,c=r-1,h=t.gammaln(r);if(e>=1)return n.max(100,r+100*n.sqrt(r));if(e<=0)return 0;for(r>1?(l=n.log(c),s=n.exp(c*(l-1)-h),u=e<.5?e:1-e,i=(2.30753+.27061*(a=n.sqrt(-2*n.log(u))))/(1+a*(.99229+.04481*a))-a,e<.5&&(i=-i),i=n.max(.001,r*n.pow(1-1/(9*r)-i/(3*n.sqrt(r)),3))):i=e<(a=1-r*(.253+.12*r))?n.pow(e/a,1/r):1-n.log(1-(e-a)/(1-a));f<12;f++){if(i<=0)return 0;if((i-=a=(o=(t.lowRegGamma(r,i)-e)/(a=r>1?s*n.exp(-(i-c)+c*(n.log(i)-l)):n.exp(-i+c*n.log(i)-h)))/(1-.5*n.min(1,o*((r-1)/i-1))))<=0&&(i=.5*(i+a)),n.abs(a)<1e-8*i)break}return i},t.erf=function(t){var e,r,i,a,o=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],u=o.length-1,l=!1,s=0,f=0;for(t<0&&(t=-t,l=!0),r=4*(e=2/(2+t))-2;u>0;u--)i=s,s=r*s-f+o[u],f=i;return a=e*n.exp(-t*t+.5*(o[0]+r*s)-f),l?a-1:1-a},t.erfc=function(n){return 1-t.erf(n)},t.erfcinv=function(e){var r,i,a,o,u=0;if(e>=2)return-100;if(e<=0)return 100;for(o=e<1?e:2-e,r=-.70711*((2.30753+.27061*(a=n.sqrt(-2*n.log(o/2))))/(1+a*(.99229+.04481*a))-a);u<2;u++)r+=(i=t.erfc(r)-o)/(1.1283791670955126*n.exp(-r*r)-r*i);return e<1?r:-r},t.ibetainv=function(e,r,i){var a,o,u,l,s,f,c,h,d,p,g=r-1,m=i-1,v=0;if(e<=0)return 0;if(e>=1)return 1;for(r>=1&&i>=1?(u=e<.5?e:1-e,f=(2.30753+.27061*(l=n.sqrt(-2*n.log(u))))/(1+l*(.99229+.04481*l))-l,e<.5&&(f=-f),c=(f*f-3)/6,h=2/(1/(2*r-1)+1/(2*i-1)),d=f*n.sqrt(c+h)/h-(1/(2*i-1)-1/(2*r-1))*(c+5/6-2/(3*h)),f=r/(r+i*n.exp(2*d))):(a=n.log(r/(r+i)),o=n.log(i/(r+i)),f=e<(l=n.exp(r*a)/r)/(d=l+(s=n.exp(i*o)/i))?n.pow(r*d*e,1/r):1-n.pow(i*d*(1-e),1/i)),p=-t.gammaln(r)-t.gammaln(i)+t.gammaln(r+i);v<10;v++){if(0===f||1===f)return f;if((f-=l=(s=(t.ibeta(f,r,i)-e)/(l=n.exp(g*n.log(f)+m*n.log(1-f)+p)))/(1-.5*n.min(1,s*(g/f-m/(1-f)))))<=0&&(f=.5*(f+l)),f>=1&&(f=.5*(f+l+1)),n.abs(l)<1e-8*f&&v>0)break}return f},t.ibeta=function(e,r,i){var a=0===e||1===e?0:n.exp(t.gammaln(r+i)-t.gammaln(r)-t.gammaln(i)+r*n.log(e)+i*n.log(1-e));return!(e<0||e>1)&&(e<(r+1)/(r+i+2)?a*t.betacf(e,r,i)/r:1-a*t.betacf(1-e,i,r)/i)},t.randn=function(e,r){var i,a,o,u,l;if(r||(r=e),e)return t.create(e,r,(function(){return t.randn()}));do{i=t._random_fn(),a=1.7156*(t._random_fn()-.5),l=(o=i-.449871)*o+(u=n.abs(a)+.386595)*(.196*u-.25472*o)}while(l>.27597&&(l>.27846||a*a>-4*n.log(i)*i*i));return a/i},t.randg=function(e,r,i){var a,o,u,l,s,f,c=e;if(i||(i=r),e||(e=1),r)return(f=t.zeros(r,i)).alter((function(){return t.randg(e)})),f;e<1&&(e+=1),a=e-1/3,o=1/n.sqrt(9*a);do{do{l=1+o*(s=t.randn())}while(l<=0);l*=l*l,u=t._random_fn()}while(u>1-.331*n.pow(s,4)&&n.log(u)>.5*s*s+a*(1-l+n.log(l)));if(e==c)return a*l;do{u=t._random_fn()}while(0===u);return n.pow(u,1/c)*a*l},function(n){for(var e=0;e<n.length;e++)!function(n){t.fn[n]=function(){return t(t.map(this,(function(e){return t[n](e)})))}}(n[e])}("gammaln gammafn factorial factorialln".split(" ")),function(n){for(var e=0;e<n.length;e++)!function(n){t.fn[n]=function(){return t(t[n].apply(null,arguments))}}(n[e])}("randn".split(" "))}(n,Math),function(t,n){function e(t,e,r,i){for(var a,o=0,u=1,l=1,s=1,f=0,c=0;n.abs((l-c)/l)>i;)c=l,u=s+(a=-(e+f)*(e+r+f)*t/(e+2*f)/(e+2*f+1))*u,l=(o=l+a*o)+(a=(f+=1)*(r-f)*t/(e+2*f-1)/(e+2*f))*l,o/=s=u+a*s,u/=s,l/=s,s=1;return l/e}function r(e,r,i){var a=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],o=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],u=.5*e;if(u>=8)return 1;var l,s=2*t.normal.cdf(u,0,1,1,0)-1;s=s>=n.exp(-50/i)?n.pow(s,i):0;for(var f=u,c=(8-u)/(l=e>3?2:3),h=f+c,d=0,p=i-1,g=1;g<=l;g++){for(var m=0,v=.5*(h+f),b=.5*(h-f),y=1;y<=12;y++){var w,x=v+b*(6<y?a[(w=12-y+1)-1]:-a[(w=y)-1]),_=x*x;if(_>60)break;var M=2*t.normal.cdf(x,0,1,1,0)*.5-2*t.normal.cdf(x,e,1,1,0)*.5;M>=n.exp(-30/p)&&(m+=M=o[w-1]*n.exp(-.5*_)*n.pow(M,p))}d+=m*=2*b*i/n.sqrt(2*n.PI),f=h,h+=c}return(s+=d)<=n.exp(-30/r)?0:(s=n.pow(s,r))>=1?1:s}!function(n){for(var e=0;e<n.length;e++)!function(n){t[n]=function t(n,e,r){return this instanceof t?(this._a=n,this._b=e,this._c=r,this):new t(n,e,r)},t.fn[n]=function(e,r,i){var a=t[n](e,r,i);return a.data=this,a},t[n].prototype.sample=function(e){var r=this._a,i=this._b,a=this._c;return e?t.alter(e,(function(){return t[n].sample(r,i,a)})):t[n].sample(r,i,a)},function(e){for(var r=0;r<e.length;r++)!function(e){t[n].prototype[e]=function(r){var i=this._a,a=this._b,o=this._c;return r||0===r||(r=this.data),"number"!=typeof r?t.fn.map.call(r,(function(r){return t[n][e](r,i,a,o)})):t[n][e](r,i,a,o)}}(e[r])}("pdf cdf inv".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){t[n].prototype[e]=function(){return t[n][e](this._a,this._b,this._c)}}(e[r])}("mean median mode variance".split(" "))}(n[e])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(e,r,i){return e>1||e<0?0:1==r&&1==i?1:r<512&&i<512?n.pow(e,r-1)*n.pow(1-e,i-1)/t.betafn(r,i):n.exp((r-1)*n.log(e)+(i-1)*n.log(1-e)-t.betaln(r,i))},cdf:function(n,e,r){return n>1||n<0?1*(n>1):t.ibeta(n,e,r)},inv:function(n,e,r){return t.ibetainv(n,e,r)},mean:function(t,n){return t/(t+n)},median:function(n,e){return t.ibetainv(.5,n,e)},mode:function(t,n){return(t-1)/(t+n-2)},sample:function(n,e){var r=t.randg(n);return r/(r+t.randg(e))},variance:function(t,e){return t*e/(n.pow(t+e,2)*(t+e+1))}}),t.extend(t.centralF,{pdf:function(e,r,i){var a;return e<0?0:r<=2?0===e&&r<2?1/0:0===e&&2===r?1:1/t.betafn(r/2,i/2)*n.pow(r/i,r/2)*n.pow(e,r/2-1)*n.pow(1+r/i*e,-(r+i)/2):(a=r*e/(i+e*r),r*(i/(i+e*r))/2*t.binomial.pdf((r-2)/2,(r+i-2)/2,a))},cdf:function(n,e,r){return n<0?0:t.ibeta(e*n/(e*n+r),e/2,r/2)},inv:function(n,e,r){return r/(e*(1/t.ibetainv(n,e/2,r/2)-1))},mean:function(t,n){return n>2?n/(n-2):void 0},mode:function(t,n){return t>2?n*(t-2)/(t*(n+2)):void 0},sample:function(n,e){return 2*t.randg(n/2)/n/(2*t.randg(e/2)/e)},variance:function(t,n){if(!(n<=4))return 2*n*n*(t+n-2)/(t*(n-2)*(n-2)*(n-4))}}),t.extend(t.cauchy,{pdf:function(t,e,r){return r<0?0:r/(n.pow(t-e,2)+n.pow(r,2))/n.PI},cdf:function(t,e,r){return n.atan((t-e)/r)/n.PI+.5},inv:function(t,e,r){return e+r*n.tan(n.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(e,r){return t.randn()*n.sqrt(1/(2*t.randg(.5)))*r+e}}),t.extend(t.chisquare,{pdf:function(e,r){return e<0?0:0===e&&2===r?.5:n.exp((r/2-1)*n.log(e)-e/2-r/2*n.log(2)-t.gammaln(r/2))},cdf:function(n,e){return n<0?0:t.lowRegGamma(e/2,n/2)},inv:function(n,e){return 2*t.gammapinv(n,.5*e)},mean:function(t){return t},median:function(t){return t*n.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(n){return 2*t.randg(n/2)},variance:function(t){return 2*t}}),t.extend(t.exponential,{pdf:function(t,e){return t<0?0:e*n.exp(-e*t)},cdf:function(t,e){return t<0?0:1-n.exp(-e*t)},inv:function(t,e){return-n.log(1-t)/e},mean:function(t){return 1/t},median:function(t){return 1/t*n.log(2)},mode:function(){return 0},sample:function(e){return-1/e*n.log(t._random_fn())},variance:function(t){return n.pow(t,-2)}}),t.extend(t.gamma,{pdf:function(e,r,i){return e<0?0:0===e&&1===r?1/i:n.exp((r-1)*n.log(e)-e/i-t.gammaln(r)-r*n.log(i))},cdf:function(n,e,r){return n<0?0:t.lowRegGamma(e,n/r)},inv:function(n,e,r){return t.gammapinv(n,e)*r},mean:function(t,n){return t*n},mode:function(t,n){if(t>1)return(t-1)*n},sample:function(n,e){return t.randg(n)*e},variance:function(t,n){return t*n*n}}),t.extend(t.invgamma,{pdf:function(e,r,i){return e<=0?0:n.exp(-(r+1)*n.log(e)-i/e-t.gammaln(r)+r*n.log(i))},cdf:function(n,e,r){return n<=0?0:1-t.lowRegGamma(e,r/n)},inv:function(n,e,r){return r/t.gammapinv(1-n,e)},mean:function(t,n){return t>1?n/(t-1):void 0},mode:function(t,n){return n/(t+1)},sample:function(n,e){return e/t.randg(n)},variance:function(t,n){if(!(t<=2))return n*n/((t-1)*(t-1)*(t-2))}}),t.extend(t.kumaraswamy,{pdf:function(t,e,r){return 0===t&&1===e?r:1===t&&1===r?e:n.exp(n.log(e)+n.log(r)+(e-1)*n.log(t)+(r-1)*n.log(1-n.pow(t,e)))},cdf:function(t,e,r){return t<0?0:t>1?1:1-n.pow(1-n.pow(t,e),r)},inv:function(t,e,r){return n.pow(1-n.pow(1-t,1/r),1/e)},mean:function(n,e){return e*t.gammafn(1+1/n)*t.gammafn(e)/t.gammafn(1+1/n+e)},median:function(t,e){return n.pow(1-n.pow(2,-1/e),1/t)},mode:function(t,e){if(t>=1&&e>=1&&1!==t&&1!==e)return n.pow((t-1)/(t*e-1),1/t)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(t,e,r){return t<=0?0:n.exp(-n.log(t)-.5*n.log(2*n.PI)-n.log(r)-n.pow(n.log(t)-e,2)/(2*r*r))},cdf:function(e,r,i){return e<0?0:.5+.5*t.erf((n.log(e)-r)/n.sqrt(2*i*i))},inv:function(e,r,i){return n.exp(-1.4142135623730951*i*t.erfcinv(2*e)+r)},mean:function(t,e){return n.exp(t+e*e/2)},median:function(t){return n.exp(t)},mode:function(t,e){return n.exp(t-e*e)},sample:function(e,r){return n.exp(t.randn()*r+e)},variance:function(t,e){return(n.exp(e*e)-1)*n.exp(2*t+e*e)}}),t.extend(t.noncentralt,{pdf:function(e,r,i){return n.abs(i)<1e-14?t.studentt.pdf(e,r):n.abs(e)<1e-14?n.exp(t.gammaln((r+1)/2)-i*i/2-.5*n.log(n.PI*r)-t.gammaln(r/2)):r/e*(t.noncentralt.cdf(e*n.sqrt(1+2/r),r+2,i)-t.noncentralt.cdf(e,r,i))},cdf:function(e,r,i){var a=1e-14;if(n.abs(i)<a)return t.studentt.cdf(e,r);var o=!1;e<0&&(o=!0,i=-i);for(var u=t.normal.cdf(-i,0,1),l=a+1,s=l,f=e*e/(e*e+r),c=0,h=n.exp(-i*i/2),d=n.exp(-i*i/2-.5*n.log(2)-t.gammaln(1.5))*i;c<200||s>a||l>a;)s=l,c>0&&(h*=i*i/(2*c),d*=i*i/(2*(c+.5))),u+=.5*(l=h*t.beta.cdf(f,c+.5,r/2)+d*t.beta.cdf(f,c+1,r/2)),c++;return o?1-u:u}}),t.extend(t.normal,{pdf:function(t,e,r){return n.exp(-.5*n.log(2*n.PI)-n.log(r)-n.pow(t-e,2)/(2*r*r))},cdf:function(e,r,i){return.5*(1+t.erf((e-r)/n.sqrt(2*i*i)))},inv:function(n,e,r){return-1.4142135623730951*r*t.erfcinv(2*n)+e},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},sample:function(n,e){return t.randn()*e+n},variance:function(t,n){return n*n}}),t.extend(t.pareto,{pdf:function(t,e,r){return t<e?0:r*n.pow(e,r)/n.pow(t,r+1)},cdf:function(t,e,r){return t<e?0:1-n.pow(e/t,r)},inv:function(t,e,r){return e/n.pow(1-t,1/r)},mean:function(t,e){if(!(e<=1))return e*n.pow(t,e)/(e-1)},median:function(t,e){return t*(e*n.SQRT2)},mode:function(t){return t},variance:function(t,e){if(!(e<=2))return t*t*e/(n.pow(e-1,2)*(e-2))}}),t.extend(t.studentt,{pdf:function(e,r){return r=r>1e100?1e100:r,1/(n.sqrt(r)*t.betafn(.5,r/2))*n.pow(1+e*e/r,-(r+1)/2)},cdf:function(e,r){var i=r/2;return t.ibeta((e+n.sqrt(e*e+r))/(2*n.sqrt(e*e+r)),i,i)},inv:function(e,r){var i=t.ibetainv(2*n.min(e,1-e),.5*r,.5);return i=n.sqrt(r*(1-i)/i),e>.5?i:-i},mean:function(t){return t>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(e){return t.randn()*n.sqrt(e/(2*t.randg(e/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(t,e,r){return t<0||e<0||r<0?0:r/e*n.pow(t/e,r-1)*n.exp(-n.pow(t/e,r))},cdf:function(t,e,r){return t<0?0:1-n.exp(-n.pow(t/e,r))},inv:function(t,e,r){return e*n.pow(-n.log(1-t),1/r)},mean:function(n,e){return n*t.gammafn(1+1/e)},median:function(t,e){return t*n.pow(n.log(2),1/e)},mode:function(t,e){return e<=1?0:t*n.pow((e-1)/e,1/e)},sample:function(e,r){return e*n.pow(-n.log(t._random_fn()),1/r)},variance:function(e,r){return e*e*t.gammafn(1+2/r)-n.pow(t.weibull.mean(e,r),2)}}),t.extend(t.uniform,{pdf:function(t,n,e){return t<n||t>e?0:1/(e-n)},cdf:function(t,n,e){return t<n?0:t<e?(t-n)/(e-n):1},inv:function(t,n,e){return n+t*(e-n)},mean:function(t,n){return.5*(t+n)},median:function(n,e){return t.mean(n,e)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,e){return n/2+e/2+(e/2-n/2)*(2*t._random_fn()-1)},variance:function(t,e){return n.pow(e-t,2)/12}}),t.extend(t.binomial,{pdf:function(e,r,i){return 0===i||1===i?r*i===e?1:0:t.combination(r,e)*n.pow(i,e)*n.pow(1-i,r-e)},cdf:function(r,i,a){var o,u=1e-10;if(r<0)return 0;if(r>=i)return 1;if(a<0||a>1||i<=0)return NaN;var l=a,s=(r=n.floor(r))+1,f=i-r,c=s+f,h=n.exp(t.gammaln(c)-t.gammaln(f)-t.gammaln(s)+s*n.log(l)+f*n.log(1-l));return o=l<(s+1)/(c+2)?h*e(l,s,f,u):1-h*e(1-l,f,s,u),n.round(1/u*(1-o))/(1/u)}}),t.extend(t.negbin,{pdf:function(e,r,i){return e===e>>>0&&(e<0?0:t.combination(e+r-1,r-1)*n.pow(1-i,e)*n.pow(i,r))},cdf:function(n,e,r){var i=0,a=0;if(n<0)return 0;for(;a<=n;a++)i+=t.negbin.pdf(a,e,r);return i}}),t.extend(t.hypgeom,{pdf:function(e,r,i,a){if(e!=e|0)return!1;if(e<0||e<i-(r-a))return 0;if(e>a||e>i)return 0;if(2*i>r)return 2*a>r?t.hypgeom.pdf(r-i-a+e,r,r-i,r-a):t.hypgeom.pdf(a-e,r,r-i,a);if(2*a>r)return t.hypgeom.pdf(i-e,r,i,r-a);if(i<a)return t.hypgeom.pdf(e,r,a,i);for(var o=1,u=0,l=0;l<e;l++){for(;o>1&&u<a;)o*=1-i/(r-u),u++;o*=(a-l)*(i-l)/((l+1)*(r-i-a+l+1))}for(;u<a;u++)o*=1-i/(r-u);return n.min(1,n.max(0,o))},cdf:function(e,r,i,a){if(e<0||e<i-(r-a))return 0;if(e>=a||e>=i)return 1;if(2*i>r)return 2*a>r?t.hypgeom.cdf(r-i-a+e,r,r-i,r-a):1-t.hypgeom.cdf(a-e-1,r,r-i,a);if(2*a>r)return 1-t.hypgeom.cdf(i-e-1,r,i,r-a);if(i<a)return t.hypgeom.cdf(e,r,a,i);for(var o=1,u=1,l=0,s=0;s<e;s++){for(;o>1&&l<a;){var f=1-i/(r-l);u*=f,o*=f,l++}o+=u*=(a-s)*(i-s)/((s+1)*(r-i-a+s+1))}for(;l<a;l++)o*=1-i/(r-l);return n.min(1,n.max(0,o))}}),t.extend(t.poisson,{pdf:function(e,r){return r<0||e%1!=0||e<0?0:n.pow(r,e)*n.exp(-r)/t.factorial(e)},cdf:function(n,e){var r=[],i=0;if(n<0)return 0;for(;i<=n;i++)r.push(t.poisson.pdf(i,e));return t.sum(r)},mean:function(t){return t},variance:function(t){return t},sampleSmall:function(e){var r=1,i=0,a=n.exp(-e);do{i++,r*=t._random_fn()}while(r>a);return i-1},sampleLarge:function(e){var r,i,a,o,u,l,s,f,c,h,d=e;for(o=n.sqrt(d),u=n.log(d),l=.02483*(s=.931+2.53*o)-.059,f=1.1239+1.1328/(s-3.4),c=.9277-3.6224/(s-2);;){if(i=n.random()-.5,a=n.random(),h=.5-n.abs(i),r=n.floor((2*l/h+s)*i+d+.43),h>=.07&&a<=c)return r;if(!(r<0||h<.013&&a>h)&&n.log(a)+n.log(f)-n.log(l/(h*h)+s)<=r*u-d-t.loggam(r+1))return r}},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),t.extend(t.triangular,{pdf:function(t,n,e,r){return e<=n||r<n||r>e?NaN:t<n||t>e?0:t<r?2*(t-n)/((e-n)*(r-n)):t===r?2/(e-n):2*(e-t)/((e-n)*(e-r))},cdf:function(t,e,r,i){return r<=e||i<e||i>r?NaN:t<=e?0:t>=r?1:t<=i?n.pow(t-e,2)/((r-e)*(i-e)):1-n.pow(r-t,2)/((r-e)*(r-i))},inv:function(t,e,r,i){return r<=e||i<e||i>r?NaN:t<=(i-e)/(r-e)?e+(r-e)*n.sqrt(t*((i-e)/(r-e))):e+(r-e)*(1-n.sqrt((1-t)*(1-(i-e)/(r-e))))},mean:function(t,n,e){return(t+n+e)/3},median:function(t,e,r){return r<=(t+e)/2?e-n.sqrt((e-t)*(e-r))/n.sqrt(2):r>(t+e)/2?t+n.sqrt((e-t)*(r-t))/n.sqrt(2):void 0},mode:function(t,n,e){return e},sample:function(e,r,i){var a=t._random_fn();return a<(i-e)/(r-e)?e+n.sqrt(a*(r-e)*(i-e)):r-n.sqrt((1-a)*(r-e)*(r-i))},variance:function(t,n,e){return(t*t+n*n+e*e-t*n-t*e-n*e)/18}}),t.extend(t.arcsine,{pdf:function(t,e,r){return r<=e?NaN:t<=e||t>=r?0:2/n.PI*n.pow(n.pow(r-e,2)-n.pow(2*t-e-r,2),-.5)},cdf:function(t,e,r){return t<e?0:t<r?2/n.PI*n.asin(n.sqrt((t-e)/(r-e))):1},inv:function(t,e,r){return e+(.5-.5*n.cos(n.PI*t))*(r-e)},mean:function(t,n){return n<=t?NaN:(t+n)/2},median:function(t,n){return n<=t?NaN:(t+n)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,r){return(e+r)/2+(r-e)/2*n.sin(2*n.PI*t.uniform.sample(0,1))},variance:function(t,e){return e<=t?NaN:n.pow(e-t,2)/8}}),t.extend(t.laplace,{pdf:function(t,e,r){return r<=0?0:n.exp(-n.abs(t-e)/r)/(2*r)},cdf:function(t,e,r){return r<=0?0:t<e?.5*n.exp((t-e)/r):1-.5*n.exp(-(t-e)/r)},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},variance:function(t,n){return 2*n*n},sample:function(e,r){var i,a=t._random_fn()-.5;return e-r*((i=a)/n.abs(i))*n.log(1-2*n.abs(a))}}),t.extend(t.tukey,{cdf:function(e,i,a){var o=i,u=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],l=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(e<=0)return 0;if(a<2||o<2)return NaN;if(!Number.isFinite(e))return 1;if(a>25e3)return r(e,1,o);var s,f=.5*a,c=f*n.log(a)-a*n.log(2)-t.gammaln(f),h=f-1,d=.25*a;s=a<=100?1:a<=800?.5:a<=5e3?.25:.125,c+=n.log(s);for(var p=0,g=1;g<=50;g++){for(var m=0,v=(2*g-1)*s,b=1;b<=16;b++){var y,w;8<b?(y=b-8-1,w=c+h*n.log(v+u[y]*s)-(u[y]*s+v)*d):(y=b-1,w=c+h*n.log(v-u[y]*s)+(u[y]*s-v)*d),w>=-30&&(m+=r(8<b?e*n.sqrt(.5*(u[y]*s+v)):e*n.sqrt(.5*(-u[y]*s+v)),1,o)*l[y]*n.exp(w))}if(g*s>=1&&m<=1e-14)break;p+=m}if(m>1e-14)throw new Error("tukey.cdf failed to converge");return p>1&&(p=1),p},inv:function(e,r,i){if(i<2||r<2)return NaN;if(e<0||e>1)return NaN;if(0===e)return 0;if(1===e)return 1/0;var a,o=function(t,e,r){var i=.5-.5*t,a=n.sqrt(n.log(1/(i*i))),o=a+((((-453642210148e-16*a-.204231210125)*a-.342242088547)*a-1)*a+.322232421088)/((((.0038560700634*a+.10353775285)*a+.531103462366)*a+.588581570495)*a+.099348462606);r<120&&(o+=(o*o*o+o)/r/4);var u=.8832-.2368*o;return r<120&&(u+=-1.214/r+1.208*o/r),o*(u*n.log(e-1)+1.4142)}(e,r,i),u=t.tukey.cdf(o,r,i)-e;a=u>0?n.max(0,o-1):o+1;for(var l,s=t.tukey.cdf(a,r,i)-e,f=1;f<50;f++)if(l=a-s*(a-o)/(s-u),u=s,o=a,l<0&&(l=0,s=-e),s=t.tukey.cdf(l,r,i)-e,a=l,n.abs(a-o)<1e-4)return l;throw new Error("tukey.inv failed to converge")}})}(n,Math),function(t,n){var e,r,i=Array.prototype.push,a=t.utils.isArray;function o(n){return a(n)||n instanceof t}t.extend({add:function(n,e){return o(e)?(o(e[0])||(e=[e]),t.map(n,(function(t,n,r){return t+e[n][r]}))):t.map(n,(function(t){return t+e}))},subtract:function(n,e){return o(e)?(o(e[0])||(e=[e]),t.map(n,(function(t,n,r){return t-e[n][r]||0}))):t.map(n,(function(t){return t-e}))},divide:function(n,e){return o(e)?(o(e[0])||(e=[e]),t.multiply(n,t.inv(e))):t.map(n,(function(t){return t/e}))},multiply:function(n,e){var r,i,a,u,l,s,f,c;if(void 0===n.length&&void 0===e.length)return n*e;if(l=n.length,s=n[0].length,f=t.zeros(l,a=o(e)?e[0].length:s),c=0,o(e)){for(;c<a;c++)for(r=0;r<l;r++){for(u=0,i=0;i<s;i++)u+=n[r][i]*e[i][c];f[r][c]=u}return 1===l&&1===c?f[0][0]:f}return t.map(n,(function(t){return t*e}))},outer:function(n,e){return t.multiply(n.map((function(t){return[t]})),[e])},dot:function(n,e){o(n[0])||(n=[n]),o(e[0])||(e=[e]);for(var r,i,a=1===n[0].length&&1!==n.length?t.transpose(n):n,u=1===e[0].length&&1!==e.length?t.transpose(e):e,l=[],s=0,f=a.length,c=a[0].length;s<f;s++){for(l[s]=[],r=0,i=0;i<c;i++)r+=a[s][i]*u[s][i];l[s]=r}return 1===l.length?l[0]:l},pow:function(e,r){return t.map(e,(function(t){return n.pow(t,r)}))},exp:function(e){return t.map(e,(function(t){return n.exp(t)}))},log:function(e){return t.map(e,(function(t){return n.log(t)}))},abs:function(e){return t.map(e,(function(t){return n.abs(t)}))},norm:function(t,e){var r=0,i=0;for(isNaN(e)&&(e=2),o(t[0])&&(t=t[0]);i<t.length;i++)r+=n.pow(n.abs(t[i]),e);return n.pow(r,1/e)},angle:function(e,r){return n.acos(t.dot(e,r)/(t.norm(e)*t.norm(r)))},aug:function(t,n){var e,r=[];for(e=0;e<t.length;e++)r.push(t[e].slice());for(e=0;e<r.length;e++)i.apply(r[e],n[e]);return r},inv:function(n){for(var e,r=n.length,i=n[0].length,a=t.identity(r,i),o=t.gauss_jordan(n,a),u=[],l=0;l<r;l++)for(u[l]=[],e=i;e<o[0].length;e++)u[l][e-i]=o[l][e];return u},det:function(t){var n,e=t.length,r=2*e,i=new Array(r),a=e-1,o=r-1,u=a-e+1,l=o,s=0,f=0;if(2===e)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(;s<r;s++)i[s]=1;for(s=0;s<e;s++){for(n=0;n<e;n++)i[u<0?u+e:u]*=t[s][n],i[l<e?l+e:l]*=t[s][n],u++,l--;u=--a-e+1,l=--o}for(s=0;s<e;s++)f+=i[s];for(;s<r;s++)f-=i[s];return f},gauss_elimination:function(e,r){var i,a,o,u,l=0,s=0,f=e.length,c=e[0].length,h=1,d=0,p=[];for(i=(e=t.aug(e,r))[0].length,l=0;l<f;l++){for(a=e[l][l],s=l,u=l+1;u<c;u++)a<n.abs(e[u][l])&&(a=e[u][l],s=u);if(s!=l)for(u=0;u<i;u++)o=e[l][u],e[l][u]=e[s][u],e[s][u]=o;for(s=l+1;s<f;s++)for(h=e[s][l]/e[l][l],u=l;u<i;u++)e[s][u]=e[s][u]-h*e[l][u]}for(l=f-1;l>=0;l--){for(d=0,s=l+1;s<=f-1;s++)d+=p[s]*e[l][s];p[l]=(e[l][i-1]-d)/e[l][l]}return p},gauss_jordan:function(e,r){var i,a,o,u=t.aug(e,r),l=u.length,s=u[0].length,f=0;for(a=0;a<l;a++){var c=a;for(o=a+1;o<l;o++)n.abs(u[o][a])>n.abs(u[c][a])&&(c=o);var h=u[a];for(u[a]=u[c],u[c]=h,o=a+1;o<l;o++)for(f=u[o][a]/u[a][a],i=a;i<s;i++)u[o][i]-=u[a][i]*f}for(a=l-1;a>=0;a--){for(f=u[a][a],o=0;o<a;o++)for(i=s-1;i>a-1;i--)u[o][i]-=u[a][i]*u[o][a]/f;for(u[a][a]/=f,i=l;i<s;i++)u[a][i]/=f}return u},triaUpSolve:function(n,e){var r,i=n[0].length,a=t.zeros(1,i)[0],o=!1;return null!=e[0].length&&(e=e.map((function(t){return t[0]})),o=!0),t.arange(i-1,-1,-1).forEach((function(o){r=t.arange(o+1,i).map((function(t){return a[t]*n[o][t]})),a[o]=(e[o]-t.sum(r))/n[o][o]})),o?a.map((function(t){return[t]})):a},triaLowSolve:function(n,e){var r,i=n[0].length,a=t.zeros(1,i)[0],o=!1;return null!=e[0].length&&(e=e.map((function(t){return t[0]})),o=!0),t.arange(i).forEach((function(i){r=t.arange(i).map((function(t){return n[i][t]*a[t]})),a[i]=(e[i]-t.sum(r))/n[i][i]})),o?a.map((function(t){return[t]})):a},lu:function(n){var e,r=n.length,i=t.identity(r),a=t.zeros(n.length,n[0].length);return t.arange(r).forEach((function(t){a[0][t]=n[0][t]})),t.arange(1,r).forEach((function(o){t.arange(o).forEach((function(r){e=t.arange(r).map((function(t){return i[o][t]*a[t][r]})),i[o][r]=(n[o][r]-t.sum(e))/a[r][r]})),t.arange(o,r).forEach((function(r){e=t.arange(o).map((function(t){return i[o][t]*a[t][r]})),a[o][r]=n[e.length][r]-t.sum(e)}))})),[i,a]},cholesky:function(e){var r,i=e.length,a=t.zeros(e.length,e[0].length);return t.arange(i).forEach((function(o){r=t.arange(o).map((function(t){return n.pow(a[o][t],2)})),a[o][o]=n.sqrt(e[o][o]-t.sum(r)),t.arange(o+1,i).forEach((function(n){r=t.arange(o).map((function(t){return a[o][t]*a[n][t]})),a[n][o]=(e[o][n]-t.sum(r))/a[o][o]}))})),a},gauss_jacobi:function(e,r,i,a){for(var o,u,l,s,f=0,c=0,h=e.length,d=[],p=[],g=[];f<h;f++)for(d[f]=[],p[f]=[],g[f]=[],c=0;c<h;c++)f>c?(d[f][c]=e[f][c],p[f][c]=g[f][c]=0):f<c?(p[f][c]=e[f][c],d[f][c]=g[f][c]=0):(g[f][c]=e[f][c],d[f][c]=p[f][c]=0);for(l=t.multiply(t.multiply(t.inv(g),t.add(d,p)),-1),u=t.multiply(t.inv(g),r),o=i,s=t.add(t.multiply(l,i),u),f=2;n.abs(t.norm(t.subtract(s,o)))>a;)o=s,s=t.add(t.multiply(l,o),u),f++;return s},gauss_seidel:function(e,r,i,a){for(var o,u,l,s,f,c=0,h=e.length,d=[],p=[],g=[];c<h;c++)for(d[c]=[],p[c]=[],g[c]=[],o=0;o<h;o++)c>o?(d[c][o]=e[c][o],p[c][o]=g[c][o]=0):c<o?(p[c][o]=e[c][o],d[c][o]=g[c][o]=0):(g[c][o]=e[c][o],d[c][o]=p[c][o]=0);for(s=t.multiply(t.multiply(t.inv(t.add(g,d)),p),-1),l=t.multiply(t.inv(t.add(g,d)),r),u=i,f=t.add(t.multiply(s,i),l),c=2;n.abs(t.norm(t.subtract(f,u)))>a;)u=f,f=t.add(t.multiply(s,u),l),c+=1;return f},SOR:function(e,r,i,a,o){for(var u,l,s,f,c,h=0,d=e.length,p=[],g=[],m=[];h<d;h++)for(p[h]=[],g[h]=[],m[h]=[],u=0;u<d;u++)h>u?(p[h][u]=e[h][u],g[h][u]=m[h][u]=0):h<u?(g[h][u]=e[h][u],p[h][u]=m[h][u]=0):(m[h][u]=e[h][u],p[h][u]=g[h][u]=0);for(f=t.multiply(t.inv(t.add(m,t.multiply(p,o))),t.subtract(t.multiply(m,1-o),t.multiply(g,o))),s=t.multiply(t.multiply(t.inv(t.add(m,t.multiply(p,o))),r),o),l=i,c=t.add(t.multiply(f,i),s),h=2;n.abs(t.norm(t.subtract(c,l)))>a;)l=c,c=t.add(t.multiply(f,l),s),h++;return c},householder:function(e){for(var r,i,a,o,u=e.length,l=e[0].length,s=0,f=[],c=[];s<u-1;s++){for(r=0,o=s+1;o<l;o++)r+=e[o][s]*e[o][s];for(r=(e[s+1][s]>0?-1:1)*n.sqrt(r),i=n.sqrt((r*r-e[s+1][s]*r)/2),(f=t.zeros(u,1))[s+1][0]=(e[s+1][s]-r)/(2*i),a=s+2;a<u;a++)f[a][0]=e[a][s]/(2*i);c=t.subtract(t.identity(u,l),t.multiply(t.multiply(f,t.transpose(f)),2)),e=t.multiply(c,t.multiply(e,c))}return e},QR:(e=t.sum,r=t.arange,function(i){var a,o,u,l=i.length,s=i[0].length,f=t.zeros(s,s);for(i=t.copy(i),o=0;o<s;o++){for(f[o][o]=n.sqrt(e(r(l).map((function(t){return i[t][o]*i[t][o]})))),a=0;a<l;a++)i[a][o]=i[a][o]/f[o][o];for(u=o+1;u<s;u++)for(f[o][u]=e(r(l).map((function(t){return i[t][o]*i[t][u]}))),a=0;a<l;a++)i[a][u]=i[a][u]-i[a][o]*f[o][u]}return[i,f]}),lstsq:function(n,e){var r=!1;void 0===e[0].length&&(e=e.map((function(t){return[t]})),r=!0);var i=t.QR(n),a=i[0],o=i[1],u=n[0].length,l=t.slice(a,{col:{end:u}}),s=function(n){var e=(n=t.copy(n)).length,r=t.identity(e);return t.arange(e-1,-1,-1).forEach((function(e){t.sliceAssign(r,{row:e},t.divide(t.slice(r,{row:e}),n[e][e])),t.sliceAssign(n,{row:e},t.divide(t.slice(n,{row:e}),n[e][e])),t.arange(e).forEach((function(i){var a=t.multiply(n[i][e],-1),o=t.slice(n,{row:i}),u=t.multiply(t.slice(n,{row:e}),a);t.sliceAssign(n,{row:i},t.add(o,u));var l=t.slice(r,{row:i}),s=t.multiply(t.slice(r,{row:e}),a);t.sliceAssign(r,{row:i},t.add(l,s))}))})),r}(t.slice(o,{row:{end:u}})),f=t.transpose(l);void 0===f[0].length&&(f=[f]);var c=t.multiply(t.multiply(s,f),e);return void 0===c.length&&(c=[[c]]),r?c.map((function(t){return t[0]})):c},jacobi:function(e){for(var r,i,a,o,u,l,s,f=1,c=e.length,h=t.identity(c,c),d=[];1===f;){for(u=e[0][1],a=0,o=1,r=0;r<c;r++)for(i=0;i<c;i++)r!=i&&u<n.abs(e[r][i])&&(u=n.abs(e[r][i]),a=r,o=i);for(l=e[a][a]===e[o][o]?e[a][o]>0?n.PI/4:-n.PI/4:n.atan(2*e[a][o]/(e[a][a]-e[o][o]))/2,(s=t.identity(c,c))[a][a]=n.cos(l),s[a][o]=-n.sin(l),s[o][a]=n.sin(l),s[o][o]=n.cos(l),h=t.multiply(h,s),e=t.multiply(t.multiply(t.inv(s),e),s),f=0,r=1;r<c;r++)for(i=1;i<c;i++)r!=i&&n.abs(e[r][i])>.001&&(f=1)}for(r=0;r<c;r++)d.push(e[r][r]);return[h,d]},rungekutta:function(t,n,e,r,i,a){var o,u,l;if(2===a)for(;r<=e;)i+=((o=n*t(r,i))+(u=n*t(r+n,i+o)))/2,r+=n;if(4===a)for(;r<=e;)i+=((o=n*t(r,i))+2*(u=n*t(r+n/2,i+o/2))+2*(l=n*t(r+n/2,i+u/2))+n*t(r+n,i+l))/6,r+=n;return i},romberg:function(t,e,r,i){for(var a,o,u,l,s,f=0,c=(r-e)/2,h=[],d=[],p=[];f<i/2;){for(s=t(e),u=e,l=0;u<=r;u+=c,l++)h[l]=u;for(a=h.length,u=1;u<a-1;u++)s+=(u%2!=0?4:2)*t(h[u]);s=c/3*(s+t(r)),p[f]=s,c/=2,f++}for(o=p.length,a=1;1!==o;){for(u=0;u<o-1;u++)d[u]=(n.pow(4,a)*p[u+1]-p[u])/(n.pow(4,a)-1);o=d.length,p=d,d=[],a++}return p},richardson:function(t,e,r,i){function a(t,n){for(var e,r=0,i=t.length;r<i;r++)t[r]===n&&(e=r);return e}for(var o,u,l,s,f,c=n.abs(r-t[a(t,r)+1]),h=0,d=[],p=[];i>=c;)o=a(t,r+i),u=a(t,r),d[h]=(e[o]-2*e[u]+e[2*u-o])/(i*i),i/=2,h++;for(s=d.length,l=1;1!=s;){for(f=0;f<s-1;f++)p[f]=(n.pow(4,l)*d[f+1]-d[f])/(n.pow(4,l)-1);s=p.length,d=p,p=[],l++}return d},simpson:function(t,n,e,r){for(var i,a=(e-n)/r,o=t(n),u=[],l=n,s=0,f=1;l<=e;l+=a,s++)u[s]=l;for(i=u.length;f<i-1;f++)o+=(f%2!=0?4:2)*t(u[f]);return a/3*(o+t(e))},hermite:function(t,n,e,r){for(var i,a=t.length,o=0,u=0,l=[],s=[],f=[],c=[];u<a;u++){for(l[u]=1,i=0;i<a;i++)u!=i&&(l[u]*=(r-t[i])/(t[u]-t[i]));for(s[u]=0,i=0;i<a;i++)u!=i&&(s[u]+=1/(t[u]-t[i]));f[u]=(1-2*(r-t[u])*s[u])*(l[u]*l[u]),c[u]=(r-t[u])*(l[u]*l[u]),o+=f[u]*n[u]+c[u]*e[u]}return o},lagrange:function(t,n,e){for(var r,i,a=0,o=0,u=t.length;o<u;o++){for(i=n[o],r=0;r<u;r++)o!=r&&(i*=(e-t[r])/(t[o]-t[r]));a+=i}return a},cubic_spline:function(n,e,r){for(var i,a,o=n.length,u=0,l=[],s=[],f=[],c=[],h=[],d=[];u<o-1;u++)c[u]=n[u+1]-n[u];for(f[0]=0,u=1;u<o-1;u++)f[u]=3/c[u]*(e[u+1]-e[u])-3/c[u-1]*(e[u]-e[u-1]);for(u=1;u<o-1;u++)l[u]=[],s[u]=[],l[u][u-1]=c[u-1],l[u][u]=2*(c[u-1]+c[u]),l[u][u+1]=c[u],s[u][0]=f[u];for(a=t.multiply(t.inv(l),s),i=0;i<o-1;i++)h[i]=(e[i+1]-e[i])/c[i]-c[i]*(a[i+1][0]+2*a[i][0])/3,d[i]=(a[i+1][0]-a[i][0])/(3*c[i]);for(i=0;i<o&&!(n[i]>r);i++);return e[i-=1]+(r-n[i])*h[i]+t.sq(r-n[i])*a[i]+(r-n[i])*t.sq(r-n[i])*d[i]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(n){var e,r,i,a,o,u=n.length,l=n[0].length,s=0,f=[],c=[],h=[],d=[],p=[],g=[],m=[];for(s=0;s<u;s++)f[s]=t.sum(n[s])/l;for(s=0;s<l;s++)for(p[s]=[],e=0;e<u;e++)p[s][e]=n[e][s]-f[e];for(p=t.transpose(p),s=0;s<u;s++)for(g[s]=[],e=0;e<u;e++)g[s][e]=t.dot([p[s]],[p[e]])/(l-1);for(o=(i=t.jacobi(g))[0],c=i[1],m=t.transpose(o),s=0;s<c.length;s++)for(e=s;e<c.length;e++)c[s]<c[e]&&(r=c[s],c[s]=c[e],c[e]=r,h=m[s],m[s]=m[e],m[e]=h);for(a=t.transpose(p),s=0;s<u;s++)for(d[s]=[],e=0;e<a.length;e++)d[s][e]=t.dot([m[s]],[a[e]]);return[n,c,m,d]}}),function(n){for(var e=0;e<n.length;e++)!function(n){t.fn[n]=function(e,r){var i=this;return r?(setTimeout((function(){r.call(i,t.fn[n].call(i,e))}),15),this):"number"==typeof t[n](this,e)?t[n](this,e):t(t[n](this,e))}}(n[e])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(n,Math),function(t,n){var e=[].slice,r=t.utils.isNumber,i=t.utils.isArray;function a(t,e,r,i){if(t>1||r>1||t<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var a=(t*e+r*i)/(e+i);return(t-r)/n.sqrt(a*(1-a)*(1/e+1/i))}t.extend({zscore:function(){var n=e.call(arguments);return r(n[1])?(n[0]-n[1])/n[2]:(n[0]-t.mean(n[1]))/t.stdev(n[1],n[2])},ztest:function(){var r,a=e.call(arguments);return i(a[1])?(r=t.zscore(a[0],a[1],a[3]),1===a[2]?t.normal.cdf(-n.abs(r),0,1):2*t.normal.cdf(-n.abs(r),0,1)):a.length>2?(r=t.zscore(a[0],a[1],a[2]),1===a[3]?t.normal.cdf(-n.abs(r),0,1):2*t.normal.cdf(-n.abs(r),0,1)):(r=a[0],1===a[1]?t.normal.cdf(-n.abs(r),0,1):2*t.normal.cdf(-n.abs(r),0,1))}}),t.extend(t.fn,{zscore:function(t,n){return(t-this.mean())/this.stdev(n)},ztest:function(e,r,i){var a=n.abs(this.zscore(e,i));return 1===r?t.normal.cdf(-a,0,1):2*t.normal.cdf(-a,0,1)}}),t.extend({tscore:function(){var r=e.call(arguments);return 4===r.length?(r[0]-r[1])/(r[2]/n.sqrt(r[3])):(r[0]-t.mean(r[1]))/(t.stdev(r[1],!0)/n.sqrt(r[1].length))},ttest:function(){var i,a=e.call(arguments);return 5===a.length?(i=n.abs(t.tscore(a[0],a[1],a[2],a[3])),1===a[4]?t.studentt.cdf(-i,a[3]-1):2*t.studentt.cdf(-i,a[3]-1)):r(a[1])?(i=n.abs(a[0]),1==a[2]?t.studentt.cdf(-i,a[1]-1):2*t.studentt.cdf(-i,a[1]-1)):(i=n.abs(t.tscore(a[0],a[1])),1==a[2]?t.studentt.cdf(-i,a[1].length-1):2*t.studentt.cdf(-i,a[1].length-1))}}),t.extend(t.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/n.sqrt(this.cols()))},ttest:function(e,r){return 1===r?1-t.studentt.cdf(n.abs(this.tscore(e)),this.cols()-1):2*t.studentt.cdf(-n.abs(this.tscore(e)),this.cols()-1)}}),t.extend({anovafscore:function(){var r,i,a,o,u,l,s,f,c=e.call(arguments);if(1===c.length){for(u=new Array(c[0].length),s=0;s<c[0].length;s++)u[s]=c[0][s];c=u}for(i=new Array,s=0;s<c.length;s++)i=i.concat(c[s]);for(a=t.mean(i),r=0,s=0;s<c.length;s++)r+=c[s].length*n.pow(t.mean(c[s])-a,2);for(r/=c.length-1,l=0,s=0;s<c.length;s++)for(o=t.mean(c[s]),f=0;f<c[s].length;f++)l+=n.pow(c[s][f]-o,2);return r/(l/(i.length-c.length))},anovaftest:function(){var n,i,a,o,u=e.call(arguments);if(r(u[0]))return 1-t.centralF.cdf(u[0],u[1],u[2]);var l=t.anovafscore(u);for(n=u.length-1,a=0,o=0;o<u.length;o++)a+=u[o].length;return i=a-n-1,1-t.centralF.cdf(l,n,i)},ftest:function(n,e,r){return 1-t.centralF.cdf(n,e,r)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var n,e=0;for(n=0;n<this.length;n++)e+=this[n].length;return t.ftest(this.anovafscore(),this.length-1,e-this.length)}}),t.extend({qscore:function(){var i,a,o,u,l,s=e.call(arguments);return r(s[0])?(i=s[0],a=s[1],o=s[2],u=s[3],l=s[4]):(i=t.mean(s[0]),a=t.mean(s[1]),o=s[0].length,u=s[1].length,l=s[2]),n.abs(i-a)/(l*n.sqrt((1/o+1/u)/2))},qtest:function(){var n,r=e.call(arguments);3===r.length?(n=r[0],r=r.slice(1)):7===r.length?(n=t.qscore(r[0],r[1],r[2],r[3],r[4]),r=r.slice(5)):(n=t.qscore(r[0],r[1],r[2]),r=r.slice(3));var i=r[0],a=r[1];return 1-t.tukey.cdf(n,a,i-a)},tukeyhsd:function(n){for(var e=t.pooledstdev(n),r=n.map((function(n){return t.mean(n)})),i=n.reduce((function(t,n){return t+n.length}),0),a=[],o=0;o<n.length;++o)for(var u=o+1;u<n.length;++u){var l=t.qtest(r[o],r[u],n[o].length,n[u].length,e,i,n.length);a.push([[o,u],l])}return a}}),t.extend({normalci:function(){var r,i=e.call(arguments),a=new Array(2);return r=4===i.length?n.abs(t.normal.inv(i[1]/2,0,1)*i[2]/n.sqrt(i[3])):n.abs(t.normal.inv(i[1]/2,0,1)*t.stdev(i[2])/n.sqrt(i[2].length)),a[0]=i[0]-r,a[1]=i[0]+r,a},tci:function(){var r,i=e.call(arguments),a=new Array(2);return r=4===i.length?n.abs(t.studentt.inv(i[1]/2,i[3]-1)*i[2]/n.sqrt(i[3])):n.abs(t.studentt.inv(i[1]/2,i[2].length-1)*t.stdev(i[2],!0)/n.sqrt(i[2].length)),a[0]=i[0]-r,a[1]=i[0]+r,a},significant:function(t,n){return t<n}}),t.extend(t.fn,{normalci:function(n,e){return t.normalci(n,e,this.toArray())},tci:function(n,e){return t.tci(n,e,this.toArray())}}),t.extend(t.fn,{oneSidedDifferenceOfProportions:function(n,e,r,i){var o=a(n,e,r,i);return t.ztest(o,1)},twoSidedDifferenceOfProportions:function(n,e,r,i){var o=a(n,e,r,i);return t.ztest(o,2)}})}(n,Math),n.models=function(){function t(t,e){var r=t.length,i=e[0].length-1,a=r-i-1,o=n.lstsq(e,t),u=n.multiply(e,o.map((function(t){return[t]}))).map((function(t){return t[0]})),l=n.subtract(t,u),s=n.mean(t),f=n.sum(u.map((function(t){return Math.pow(t-s,2)}))),c=n.sum(t.map((function(t,n){return Math.pow(t-u[n],2)}))),h=f+c;return{exog:e,endog:t,nobs:r,df_model:i,df_resid:a,coef:o,predict:u,resid:l,ybar:s,SST:h,SSE:f,SSR:c,R2:f/h}}function e(e){var r,i,a=(r=e.exog,i=r[0].length,n.arange(i).map((function(e){var a=n.arange(i).filter((function(t){return t!==e}));return t(n.col(r,e).map((function(t){return t[0]})),n.col(r,a))}))),o=Math.sqrt(e.SSR/e.df_resid),u=a.map((function(t){var n=t.SST,e=t.R2;return o/Math.sqrt(n*(1-e))})),l=e.coef.map((function(t,n){return(t-0)/u[n]})),s=l.map((function(t){var r=n.studentt.cdf(t,e.df_resid);return 2*(r>.5?1-r:r)})),f=n.studentt.inv(.975,e.df_resid),c=e.coef.map((function(t,n){var e=f*u[n];return[t-e,t+e]}));return{se:u,t:l,p:s,sigmaHat:o,interval95:c}}return{ols:function(r,i){var a=t(r,i),o=e(a),u=function(t){var e,r,i,a=t.R2/t.df_model/((1-t.R2)/t.df_resid);return{F_statistic:a,pvalue:1-(e=a,r=t.df_model,i=t.df_resid,n.beta.cdf(e/(i/r+e),r/2,i/2))}}(a),l=1-(1-a.R2)*((a.nobs-1)/a.df_resid);return a.t=o,a.f=u,a.adjust_R2=l,a}}}(),n.extend({buildxmatrix:function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++){var r=[1];t[e]=r.concat(arguments[e])}return n(t)},builddxmatrix:function(){for(var t=new Array(arguments[0].length),e=0;e<arguments[0].length;e++){var r=[1];t[e]=r.concat(arguments[0][e])}return n(t)},buildjxmatrix:function(t){for(var e=new Array(t.length),r=0;r<t.length;r++)e[r]=t[r];return n.builddxmatrix(e)},buildymatrix:function(t){return n(t).transpose()},buildjymatrix:function(t){return t.transpose()},matrixmult:function(t,e){var r,i,a,o,u;if(t.cols()==e.rows()){if(e.rows()>1){for(o=[],r=0;r<t.rows();r++)for(o[r]=[],i=0;i<e.cols();i++){for(u=0,a=0;a<t.cols();a++)u+=t.toArray()[r][a]*e.toArray()[a][i];o[r][i]=u}return n(o)}for(o=[],r=0;r<t.rows();r++)for(o[r]=[],i=0;i<e.cols();i++){for(u=0,a=0;a<t.cols();a++)u+=t.toArray()[r][a]*e.toArray()[i];o[r][i]=u}return n(o)}},regress:function(t,e){var r=n.xtranspxinv(t),i=t.transpose(),a=n.matrixmult(n(r),i);return n.matrixmult(a,e)},regresst:function(t,e,r){var i=n.regress(t,e),a={anova:{}},o=n.jMatYBar(t,i);a.yBar=o;var u=e.mean();a.anova.residuals=n.residuals(e,o),a.anova.ssr=n.ssr(o,u),a.anova.msr=a.anova.ssr/(t[0].length-1),a.anova.sse=n.sse(e,o),a.anova.mse=a.anova.sse/(e.length-(t[0].length-1)-1),a.anova.sst=n.sst(e,u),a.anova.mst=a.anova.sst/(e.length-1),a.anova.r2=1-a.anova.sse/a.anova.sst,a.anova.r2<0&&(a.anova.r2=0),a.anova.fratio=a.anova.msr/a.anova.mse,a.anova.pvalue=n.anovaftest(a.anova.fratio,t[0].length-1,e.length-(t[0].length-1)-1),a.anova.rmse=Math.sqrt(a.anova.mse),a.anova.r2adj=1-a.anova.mse/a.anova.mst,a.anova.r2adj<0&&(a.anova.r2adj=0),a.stats=new Array(t[0].length);for(var l,s,f,c=n.xtranspxinv(t),h=0;h<i.length;h++)l=Math.sqrt(a.anova.mse*Math.abs(c[h][h])),s=Math.abs(i[h]/l),f=n.ttest(s,e.length-t[0].length-1,r),a.stats[h]=[i[h],l,s,f];return a.regress=i,a},xtranspx:function(t){return n.matrixmult(t.transpose(),t)},xtranspxinv:function(t){var e=n.matrixmult(t.transpose(),t);return n.inv(e)},jMatYBar:function(t,e){var r=n.matrixmult(t,e);return new n(r)},residuals:function(t,e){return n.matrixsubtract(t,e)},ssr:function(t,n){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r]-n,2);return e},sse:function(t,n){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r]-n[r],2);return e},sst:function(t,n){for(var e=0,r=0;r<t.length;r++)e+=Math.pow(t[r]-n,2);return e},matrixsubtract:function(t,e){for(var r=new Array(t.length),i=0;i<t.length;i++){r[i]=new Array(t[i].length);for(var a=0;a<t[i].length;a++)r[i][a]=t[i][a]-e[i][a]}return n(r)}}),n.jStat=n,n)},409:function(t,n){!function(t){"use strict";t.SVD=function(t,n,e,r,i){if(n=void 0===n||n,e=void 0===e||e,i=1e-64/(r=r||Math.pow(2,-52)),!t)throw new TypeError("Matrix a is not defined");var a,o,u,l,s,f,c,h,d,p,g,m,v=t[0].length,b=t.length;if(b<v)throw new TypeError("Invalid matrix: m < n");for(var y=[],w=[],x=[],_="f"===n?b:v,M=p=c=0;M<b;M++)w[M]=new Array(_).fill(0);for(M=0;M<v;M++)x[M]=new Array(v).fill(0);var A,k=new Array(v).fill(0);for(M=0;M<b;M++)for(a=0;a<v;a++)w[M][a]=t[M][a];for(M=0;M<v;M++){for(y[M]=c,d=0,u=M+1,a=M;a<b;a++)d+=Math.pow(w[a][M],2);if(d<i)c=0;else for(h=(f=w[M][M])*(c=f<0?Math.sqrt(d):-Math.sqrt(d))-d,w[M][M]=f-c,a=u;a<v;a++){for(d=0,o=M;o<b;o++)d+=w[o][M]*w[o][a];for(f=d/h,o=M;o<b;o++)w[o][a]=w[o][a]+f*w[o][M]}for(k[M]=c,d=0,a=u;a<v;a++)d+=Math.pow(w[M][a],2);if(d<i)c=0;else{for(h=(f=w[M][M+1])*(c=f<0?Math.sqrt(d):-Math.sqrt(d))-d,w[M][M+1]=f-c,a=u;a<v;a++)y[a]=w[M][a]/h;for(a=u;a<b;a++){for(d=0,o=u;o<v;o++)d+=w[a][o]*w[M][o];for(o=u;o<v;o++)w[a][o]=w[a][o]+d*y[o]}}p<(g=Math.abs(k[M])+Math.abs(y[M]))&&(p=g)}if(e)for(M=v-1;0<=M;M--){if(0!==c){for(h=w[M][M+1]*c,a=u;a<v;a++)x[a][M]=w[M][a]/h;for(a=u;a<v;a++){for(d=0,o=u;o<v;o++)d+=w[M][o]*x[o][a];for(o=u;o<v;o++)x[o][a]=x[o][a]+d*x[o][M]}}for(a=u;a<v;a++)x[M][a]=0,x[a][M]=0;x[M][M]=1,c=y[M],u=M}if(n){if("f"===n)for(M=v;M<b;M++){for(a=v;a<b;a++)w[M][a]=0;w[M][M]=1}for(M=v-1;0<=M;M--){for(u=M+1,c=k[M],a=u;a<_;a++)w[M][a]=0;if(0!==c){for(h=w[M][M]*c,a=u;a<_;a++){for(d=0,o=u;o<b;o++)d+=w[o][M]*w[o][a];for(f=d/h,o=M;o<b;o++)w[o][a]=w[o][a]+f*w[o][M]}for(a=M;a<b;a++)w[a][M]=w[a][M]/c}else for(a=M;a<b;a++)w[a][M]=0;w[M][M]=w[M][M]+1}}for(r*=p,o=v-1;0<=o;o--)for(var S=0;S<50;S++){for(A=!1,u=o;0<=u;u--){if(Math.abs(y[u])<=r){A=!0;break}if(Math.abs(k[u-1])<=r)break}if(!A)for(s=0,l=u-(d=1),M=u;M<o+1&&(f=d*y[M],y[M]=s*y[M],!(Math.abs(f)<=r));M++)if(c=k[M],k[M]=Math.sqrt(f*f+c*c),s=c/(h=k[M]),d=-f/h,n)for(a=0;a<b;a++)g=w[a][l],m=w[a][M],w[a][l]=g*s+m*d,w[a][M]=-g*d+m*s;if(m=k[o],u===o){if(m<0&&(k[o]=-m,e))for(a=0;a<v;a++)x[a][o]=-x[a][o];break}for(p=k[u],f=(((g=k[o-1])-m)*(g+m)+((c=y[o-1])-(h=y[o]))*(c+h))/(2*h*g),c=Math.sqrt(f*f+1),f=((p-m)*(p+m)+h*(g/(f<0?f-c:f+c)-h))/p,M=u+(d=s=1);M<o+1;M++){if(c=y[M],g=k[M],h=d*c,c*=s,m=Math.sqrt(f*f+h*h),f=p*(s=f/(y[M-1]=m))+c*(d=h/m),c=-p*d+c*s,h=g*d,g*=s,e)for(a=0;a<v;a++)p=x[a][M-1],m=x[a][M],x[a][M-1]=p*s+m*d,x[a][M]=-p*d+m*s;if(m=Math.sqrt(f*f+h*h),f=(s=f/(k[M-1]=m))*c+(d=h/m)*g,p=-d*c+s*g,n)for(a=0;a<b;a++)g=w[a][M-1],m=w[a][M],w[a][M-1]=g*s+m*d,w[a][M]=-g*d+m*s}y[u]=0,y[o]=f,k[o]=p}for(M=0;M<v;M++)k[M]<r&&(k[M]=0);return{u:w,q:k,v:x}},t.VERSION="1.1.1",Object.defineProperty(t,"__esModule",{value:!0})}(n)}},n={};function e(r){var i=n[r];if(void 0!==i)return i.exports;var a=n[r]={exports:{}};return t[r].call(a.exports,a,a.exports,e),a.exports}e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";e.r(r),e.d(r,{Langevitour:()=>ti});var t=e(162),n=e(409);function i(){}function a(t){return null==t?i:function(){return this.querySelector(t)}}function o(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function u(){return[]}function l(t){return null==t?u:function(){return this.querySelectorAll(t)}}function s(t){return function(){return this.matches(t)}}function f(t){return function(n){return n.matches(t)}}var c=Array.prototype.find;function h(){return this.firstElementChild}var d=Array.prototype.filter;function p(){return Array.from(this.children)}function g(t){return new Array(t.length)}function m(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}function v(t){return function(){return t}}function b(t,n,e,r,i,a){for(var o,u=0,l=n.length,s=a.length;u<s;++u)(o=n[u])?(o.__data__=a[u],r[u]=o):e[u]=new m(t,a[u]);for(;u<l;++u)(o=n[u])&&(i[u]=o)}function y(t,n,e,r,i,a,o){var u,l,s,f=new Map,c=n.length,h=a.length,d=new Array(c);for(u=0;u<c;++u)(l=n[u])&&(d[u]=s=o.call(l,l.__data__,u,n)+"",f.has(s)?i[u]=l:f.set(s,l));for(u=0;u<h;++u)s=o.call(t,a[u],u,a)+"",(l=f.get(s))?(r[u]=l,l.__data__=a[u],f.delete(s)):e[u]=new m(t,a[u]);for(u=0;u<c;++u)(l=n[u])&&f.get(d[u])===l&&(i[u]=l)}function w(t){return t.__data__}function x(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function _(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}m.prototype={constructor:m,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var M="http://www.w3.org/1999/xhtml";const A={svg:"http://www.w3.org/2000/svg",xhtml:M,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function k(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),A.hasOwnProperty(n)?{space:A[n],local:t}:t}function S(t){return function(){this.removeAttribute(t)}}function N(t){return function(){this.removeAttributeNS(t.space,t.local)}}function q(t,n){return function(){this.setAttribute(t,n)}}function E(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function C(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}function j(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function I(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function P(t){return function(){this.style.removeProperty(t)}}function T(t,n,e){return function(){this.style.setProperty(t,n,e)}}function z(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function $(t,n){return t.style.getPropertyValue(n)||I(t).getComputedStyle(t,null).getPropertyValue(n)}function R(t){return function(){delete this[t]}}function D(t,n){return function(){this[t]=n}}function O(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}function F(t){return t.trim().split(/^|\s+/)}function X(t){return t.classList||new L(t)}function L(t){this._node=t,this._names=F(t.getAttribute("class")||"")}function B(t,n){for(var e=X(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function H(t,n){for(var e=X(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function Y(t){return function(){B(this,t)}}function V(t){return function(){H(this,t)}}function W(t,n){return function(){(n.apply(this,arguments)?B:H)(this,t)}}function G(){this.textContent=""}function U(t){return function(){this.textContent=t}}function J(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}function Q(){this.innerHTML=""}function K(t){return function(){this.innerHTML=t}}function Z(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}function tt(){this.nextSibling&&this.parentNode.appendChild(this)}function nt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function et(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===M&&n.documentElement.namespaceURI===M?n.createElement(t):n.createElementNS(e,t)}}function rt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function it(t){var n=k(t);return(n.local?rt:et)(n)}function at(){return null}function ot(){var t=this.parentNode;t&&t.removeChild(this)}function ut(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function lt(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function st(t){return t.trim().split(/^|\s+/).map((function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}}))}function ft(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,a=n.length;r<a;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.options);++i?n.length=i:delete this.__on}}}function ct(t,n,e){return function(){var r,i=this.__on,a=function(t){return function(n){t.call(this,n,this.__data__)}}(n);if(i)for(var o=0,u=i.length;o<u;++o)if((r=i[o]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=e),void(r.value=n);this.addEventListener(t.type,a,e),r={type:t.type,name:t.name,value:n,listener:a,options:e},i?i.push(r):this.__on=[r]}}function ht(t,n,e){var r=I(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function dt(t,n){return function(){return ht(this,t,n)}}function pt(t,n){return function(){return ht(this,t,n.apply(this,arguments))}}L.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var gt=[null];function mt(t,n){this._groups=t,this._parents=n}function vt(){return new mt([[document.documentElement]],gt)}mt.prototype=vt.prototype={constructor:mt,select:function(t){"function"!=typeof t&&(t=a(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,u,l=n[i],s=l.length,f=r[i]=new Array(s),c=0;c<s;++c)(o=l[c])&&(u=t.call(o,o.__data__,c,l))&&("__data__"in o&&(u.__data__=o.__data__),f[c]=u);return new mt(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return o(t.apply(this,arguments))}}(t):l(t);for(var n=this._groups,e=n.length,r=[],i=[],a=0;a<e;++a)for(var u,s=n[a],f=s.length,c=0;c<f;++c)(u=s[c])&&(r.push(t.call(u,u.__data__,c,s)),i.push(u));return new mt(r,i)},selectChild:function(t){return this.select(null==t?h:function(t){return function(){return c.call(this.children,t)}}("function"==typeof t?t:f(t)))},selectChildren:function(t){return this.selectAll(null==t?p:function(t){return function(){return d.call(this.children,t)}}("function"==typeof t?t:f(t)))},filter:function(t){"function"!=typeof t&&(t=s(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a,o=n[i],u=o.length,l=r[i]=[],f=0;f<u;++f)(a=o[f])&&t.call(a,a.__data__,f,o)&&l.push(a);return new mt(r,this._parents)},data:function(t,n){if(!arguments.length)return Array.from(this,w);var e=n?y:b,r=this._parents,i=this._groups;"function"!=typeof t&&(t=v(t));for(var a=i.length,o=new Array(a),u=new Array(a),l=new Array(a),s=0;s<a;++s){var f=r[s],c=i[s],h=c.length,d=x(t.call(f,f&&f.__data__,s,r)),p=d.length,g=u[s]=new Array(p),m=o[s]=new Array(p),_=l[s]=new Array(h);e(f,c,g,m,_,d,n);for(var M,A,k=0,S=0;k<p;++k)if(M=g[k]){for(k>=S&&(S=k+1);!(A=m[S])&&++S<p;);M._next=A||null}}return(o=new mt(o,r))._enter=u,o._exit=l,o},enter:function(){return new mt(this._enter||this._groups.map(g),this._parents)},exit:function(){return new mt(this._exit||this._groups.map(g),this._parents)},join:function(t,n,e){var r=this.enter(),i=this,a=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=n&&(i=n(i))&&(i=i.selection()),null==e?a.remove():e(a),r&&i?r.merge(i).order():i},merge:function(t){for(var n=t.selection?t.selection():t,e=this._groups,r=n._groups,i=e.length,a=r.length,o=Math.min(i,a),u=new Array(i),l=0;l<o;++l)for(var s,f=e[l],c=r[l],h=f.length,d=u[l]=new Array(h),p=0;p<h;++p)(s=f[p]||c[p])&&(d[p]=s);for(;l<i;++l)u[l]=e[l];return new mt(u,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=_);for(var e=this._groups,r=e.length,i=new Array(r),a=0;a<r;++a){for(var o,u=e[a],l=u.length,s=i[a]=new Array(l),f=0;f<l;++f)(o=u[f])&&(s[f]=o);s.sort(n)}return new mt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){let t=0;for(const n of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,a=n[e],o=0,u=a.length;o<u;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,n){var e=k(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?N:S:"function"==typeof n?e.local?j:C:e.local?E:q)(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?P:"function"==typeof n?z:T)(t,n,null==e?"":e)):$(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?R:"function"==typeof n?O:D)(t,n)):this.node()[t]},classed:function(t,n){var e=F(t+"");if(arguments.length<2){for(var r=X(this.node()),i=-1,a=e.length;++i<a;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?W:n?Y:V)(e,n))},text:function(t){return arguments.length?this.each(null==t?G:("function"==typeof t?J:U)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Q:("function"==typeof t?Z:K)(t)):this.node().innerHTML},raise:function(){return this.each(tt)},lower:function(){return this.each(nt)},append:function(t){var n="function"==typeof t?t:it(t);return this.select((function(){return this.appendChild(n.apply(this,arguments))}))},insert:function(t,n){var e="function"==typeof t?t:it(t),r=null==n?at:"function"==typeof n?n:a(n);return this.select((function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(ot)},clone:function(t){return this.select(t?lt:ut)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,a=st(t+""),o=a.length;if(!(arguments.length<2)){for(u=n?ct:ft,r=0;r<o;++r)this.each(u(a[r],n,e));return this}var u=this.node().__on;if(u)for(var l,s=0,f=u.length;s<f;++s)for(r=0,l=u[s];r<o;++r)if((i=a[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,n){return this.each(("function"==typeof n?pt:dt)(t,n))},[Symbol.iterator]:function*(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r,i=t[n],a=0,o=i.length;a<o;++a)(r=i[a])&&(yield r)}};const bt=vt;var yt={value:()=>{}};function wt(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new xt(r)}function xt(t){this._=t}function _t(t,n){return t.trim().split(/^|\s+/).map((function(t){var e="",r=t.indexOf(".");if(r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))}function Mt(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}function At(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=yt,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}xt.prototype=wt.prototype={constructor:xt,on:function(t,n){var e,r=this._,i=_t(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++a<o;)if(e=(t=i[a]).type)r[e]=At(r[e],t.name,n);else if(null==n)for(e in r)r[e]=At(r[e],t.name,null);return this}for(;++a<o;)if((e=(t=i[a]).type)&&(e=Mt(r[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new xt(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,i=new Array(e),a=0;a<e;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,e=(r=this._[t]).length;a<e;++a)r[a].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(n,e)}};const kt=wt;var St,Nt,qt=0,Et=0,Ct=0,jt=0,It=0,Pt=0,Tt="object"==typeof performance&&performance.now?performance:Date,zt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function $t(){return It||(zt(Rt),It=Tt.now()+Pt)}function Rt(){It=0}function Dt(){this._call=this._time=this._next=null}function Ot(t,n,e){var r=new Dt;return r.restart(t,n,e),r}function Ft(){It=(jt=Tt.now())+Pt,qt=Et=0;try{!function(){$t(),++qt;for(var t,n=St;n;)(t=It-n._time)>=0&&n._call.call(void 0,t),n=n._next;--qt}()}finally{qt=0,function(){for(var t,n,e=St,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:St=n);Nt=t,Lt(r)}(),It=0}}function Xt(){var t=Tt.now(),n=t-jt;n>1e3&&(Pt-=n,jt=t)}function Lt(t){qt||(Et&&(Et=clearTimeout(Et)),t-It>24?(t<1/0&&(Et=setTimeout(Ft,t-Tt.now()-Pt)),Ct&&(Ct=clearInterval(Ct))):(Ct||(jt=Tt.now(),Ct=setInterval(Xt,1e3)),qt=1,zt(Ft)))}function Bt(t,n,e){var r=new Dt;return n=null==n?0:+n,r.restart((e=>{r.stop(),t(e+n)}),n,e),r}Dt.prototype=Ot.prototype={constructor:Dt,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?$t():+e)+(null==n?0:+n),this._next||Nt===this||(Nt?Nt._next=this:St=this,Nt=this),this._call=t,this._time=e,Lt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Lt())}};var Ht=kt("start","end","cancel","interrupt"),Yt=[];function Vt(t,n,e,r,i,a){var o=t.__transition;if(o){if(e in o)return}else t.__transition={};!function(t,n,e){var r,i=t.__transition;function a(l){var s,f,c,h;if(1!==e.state)return u();for(s in i)if((h=i[s]).name===e.name){if(3===h.state)return Bt(a);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[s]):+s<n&&(h.state=6,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[s])}if(Bt((function(){3===e.state&&(e.state=4,e.timer.restart(o,e.delay,e.time),o(l))})),e.state=2,e.on.call("start",t,t.__data__,e.index,e.group),2===e.state){for(e.state=3,r=new Array(c=e.tween.length),s=0,f=-1;s<c;++s)(h=e.tween[s].value.call(t,t.__data__,e.index,e.group))&&(r[++f]=h);r.length=f+1}}function o(n){for(var i=n<e.duration?e.ease.call(null,n/e.duration):(e.timer.restart(u),e.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(t,i);5===e.state&&(e.on.call("end",t,t.__data__,e.index,e.group),u())}function u(){for(var r in e.state=6,e.timer.stop(),delete i[n],i)return;delete t.__transition}i[n]=e,e.timer=Ot((function(t){e.state=1,e.timer.restart(a,e.delay,e.time),e.delay<=t&&a(t-e.delay)}),0,e.time)}(t,e,{name:n,index:r,group:i,on:Ht,tween:Yt,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function Wt(t,n){var e=Ut(t,n);if(e.state>0)throw new Error("too late; already scheduled");return e}function Gt(t,n){var e=Ut(t,n);if(e.state>3)throw new Error("too late; already running");return e}function Ut(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function Jt(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}var Qt,Kt=180/Math.PI,Zt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tn(t,n,e,r,i,a){var o,u,l;return(o=Math.sqrt(t*t+n*n))&&(t/=o,n/=o),(l=t*e+n*r)&&(e-=t*l,r-=n*l),(u=Math.sqrt(e*e+r*r))&&(e/=u,r/=u,l/=u),t*r<n*e&&(t=-t,n=-n,l=-l,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(n,t)*Kt,skewX:Math.atan(l)*Kt,scaleX:o,scaleY:u}}function nn(t,n,e,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var u=[],l=[];return a=t(a),o=t(o),function(t,r,i,a,o,u){if(t!==i||r!==a){var l=o.push("translate(",null,n,null,e);u.push({i:l-4,x:Jt(t,i)},{i:l-2,x:Jt(r,a)})}else(i||a)&&o.push("translate("+i+n+a+e)}(a.translateX,a.translateY,o.translateX,o.translateY,u,l),function(t,n,e,a){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),a.push({i:e.push(i(e)+"rotate(",null,r)-2,x:Jt(t,n)})):n&&e.push(i(e)+"rotate("+n+r)}(a.rotate,o.rotate,u,l),function(t,n,e,a){t!==n?a.push({i:e.push(i(e)+"skewX(",null,r)-2,x:Jt(t,n)}):n&&e.push(i(e)+"skewX("+n+r)}(a.skewX,o.skewX,u,l),function(t,n,e,r,a,o){if(t!==e||n!==r){var u=a.push(i(a)+"scale(",null,",",null,")");o.push({i:u-4,x:Jt(t,e)},{i:u-2,x:Jt(n,r)})}else 1===e&&1===r||a.push(i(a)+"scale("+e+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,u,l),a=o=null,function(t){for(var n,e=-1,r=l.length;++e<r;)u[(n=l[e]).i]=n.x(t);return u.join("")}}}var en=nn((function(t){const n=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?Zt:tn(n.a,n.b,n.c,n.d,n.e,n.f)}),"px, ","px)","deg)"),rn=nn((function(t){return null==t?Zt:(Qt||(Qt=document.createElementNS("http://www.w3.org/2000/svg","g")),Qt.setAttribute("transform",t),(t=Qt.transform.baseVal.consolidate())?tn((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Zt)}),", ",")",")");function an(t,n){var e,r;return function(){var i=Gt(this,t),a=i.tween;if(a!==e)for(var o=0,u=(r=e=a).length;o<u;++o)if(r[o].name===n){(r=r.slice()).splice(o,1);break}i.tween=r}}function on(t,n,e){var r,i;if("function"!=typeof e)throw new Error;return function(){var a=Gt(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var u={name:n,value:e},l=0,s=i.length;l<s;++l)if(i[l].name===n){i[l]=u;break}l===s&&i.push(u)}a.tween=i}}function un(t,n,e){var r=t._id;return t.each((function(){var t=Gt(this,r);(t.value||(t.value={}))[n]=e.apply(this,arguments)})),function(t){return Ut(t,r).value[n]}}function ln(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function sn(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function fn(){}var cn=.7,hn=1/cn,dn="\\s*([+-]?\\d+)\\s*",pn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mn=/^#([0-9a-f]{3,8})$/,vn=new RegExp(`^rgb\\(${dn},${dn},${dn}\\)$`),bn=new RegExp(`^rgb\\(${gn},${gn},${gn}\\)$`),yn=new RegExp(`^rgba\\(${dn},${dn},${dn},${pn}\\)$`),wn=new RegExp(`^rgba\\(${gn},${gn},${gn},${pn}\\)$`),xn=new RegExp(`^hsl\\(${pn},${gn},${gn}\\)$`),_n=new RegExp(`^hsla\\(${pn},${gn},${gn},${pn}\\)$`),Mn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function An(){return this.rgb().formatHex()}function kn(){return this.rgb().formatRgb()}function Sn(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=mn.exec(t))?(e=n[1].length,n=parseInt(n[1],16),6===e?Nn(n):3===e?new jn(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===e?qn(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===e?qn(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=vn.exec(t))?new jn(n[1],n[2],n[3],1):(n=bn.exec(t))?new jn(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=yn.exec(t))?qn(n[1],n[2],n[3],n[4]):(n=wn.exec(t))?qn(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=xn.exec(t))?Rn(n[1],n[2]/100,n[3]/100,1):(n=_n.exec(t))?Rn(n[1],n[2]/100,n[3]/100,n[4]):Mn.hasOwnProperty(t)?Nn(Mn[t]):"transparent"===t?new jn(NaN,NaN,NaN,0):null}function Nn(t){return new jn(t>>16&255,t>>8&255,255&t,1)}function qn(t,n,e,r){return r<=0&&(t=n=e=NaN),new jn(t,n,e,r)}function En(t){return t instanceof fn||(t=Sn(t)),t?new jn((t=t.rgb()).r,t.g,t.b,t.opacity):new jn}function Cn(t,n,e,r){return 1===arguments.length?En(t):new jn(t,n,e,null==r?1:r)}function jn(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function In(){return`#${$n(this.r)}${$n(this.g)}${$n(this.b)}`}function Pn(){const t=Tn(this.opacity);return`${1===t?"rgb(":"rgba("}${zn(this.r)}, ${zn(this.g)}, ${zn(this.b)}${1===t?")":`, ${t})`}`}function Tn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function zn(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function $n(t){return((t=zn(t))<16?"0":"")+t.toString(16)}function Rn(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new On(t,n,e,r)}function Dn(t){if(t instanceof On)return new On(t.h,t.s,t.l,t.opacity);if(t instanceof fn||(t=Sn(t)),!t)return new On;if(t instanceof On)return t;var n=(t=t.rgb()).r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),a=Math.max(n,e,r),o=NaN,u=a-i,l=(a+i)/2;return u?(o=n===a?(e-r)/u+6*(e<r):e===a?(r-n)/u+2:(n-e)/u+4,u/=l<.5?a+i:2-a-i,o*=60):u=l>0&&l<1?0:o,new On(o,u,l,t.opacity)}function On(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function Fn(t){return(t=(t||0)%360)<0?t+360:t}function Xn(t){return Math.max(0,Math.min(1,t||0))}function Ln(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}function Bn(t,n,e,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*n+(4-6*a+3*o)*e+(1+3*t+3*a-3*o)*r+o*i)/6}ln(fn,Sn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:An,formatHex:An,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Dn(this).formatHsl()},formatRgb:kn,toString:kn}),ln(jn,Cn,sn(fn,{brighter(t){return t=null==t?hn:Math.pow(hn,t),new jn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?cn:Math.pow(cn,t),new jn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new jn(zn(this.r),zn(this.g),zn(this.b),Tn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:In,formatHex:In,formatHex8:function(){return`#${$n(this.r)}${$n(this.g)}${$n(this.b)}${$n(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Pn,toString:Pn})),ln(On,(function(t,n,e,r){return 1===arguments.length?Dn(t):new On(t,n,e,null==r?1:r)}),sn(fn,{brighter(t){return t=null==t?hn:Math.pow(hn,t),new On(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?cn:Math.pow(cn,t),new On(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new jn(Ln(t>=240?t-240:t+120,i,r),Ln(t,i,r),Ln(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new On(Fn(this.h),Xn(this.s),Xn(this.l),Tn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Tn(this.opacity);return`${1===t?"hsl(":"hsla("}${Fn(this.h)}, ${100*Xn(this.s)}%, ${100*Xn(this.l)}%${1===t?")":`, ${t})`}`}}));const Hn=t=>()=>t;function Yn(t,n){var e=n-t;return e?function(t,n){return function(e){return t+e*n}}(t,e):Hn(isNaN(t)?n:t)}const Vn=function t(n){var e=function(t){return 1==(t=+t)?Yn:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}(n,e,t):Hn(isNaN(n)?e:n)}}(n);function r(t,n){var r=e((t=Cn(t)).r,(n=Cn(n)).r),i=e(t.g,n.g),a=e(t.b,n.b),o=Yn(t.opacity,n.opacity);return function(n){return t.r=r(n),t.g=i(n),t.b=a(n),t.opacity=o(n),t+""}}return r.gamma=t,r}(1);function Wn(t){return function(n){var e,r,i=n.length,a=new Array(i),o=new Array(i),u=new Array(i);for(e=0;e<i;++e)r=Cn(n[e]),a[e]=r.r||0,o[e]=r.g||0,u[e]=r.b||0;return a=t(a),o=t(o),u=t(u),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=u(t),r+""}}}Wn((function(t){var n=t.length-1;return function(e){var r=e<=0?e=0:e>=1?(e=1,n-1):Math.floor(e*n),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,u=r<n-1?t[r+2]:2*a-i;return Bn((e-r/n)*n,o,i,a,u)}})),Wn((function(t){var n=t.length;return function(e){var r=Math.floor(((e%=1)<0?++e:e)*n),i=t[(r+n-1)%n],a=t[r%n],o=t[(r+1)%n],u=t[(r+2)%n];return Bn((e-r/n)*n,i,a,o,u)}}));var Gn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Un=new RegExp(Gn.source,"g");function Jn(t,n){var e,r,i,a=Gn.lastIndex=Un.lastIndex=0,o=-1,u=[],l=[];for(t+="",n+="";(e=Gn.exec(t))&&(r=Un.exec(n));)(i=r.index)>a&&(i=n.slice(a,i),u[o]?u[o]+=i:u[++o]=i),(e=e[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,l.push({i:o,x:Jt(e,r)})),a=Un.lastIndex;return a<n.length&&(i=n.slice(a),u[o]?u[o]+=i:u[++o]=i),u.length<2?l[0]?function(t){return function(n){return t(n)+""}}(l[0].x):function(t){return function(){return t}}(n):(n=l.length,function(t){for(var e,r=0;r<n;++r)u[(e=l[r]).i]=e.x(t);return u.join("")})}function Qn(t,n){var e;return("number"==typeof n?Jt:n instanceof Sn?Vn:(e=Sn(n))?(n=e,Vn):Jn)(t,n)}function Kn(t){return function(){this.removeAttribute(t)}}function Zn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function te(t,n,e){var r,i,a=e+"";return function(){var o=this.getAttribute(t);return o===a?null:o===r?i:i=n(r=o,e)}}function ne(t,n,e){var r,i,a=e+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===r?i:i=n(r=o,e)}}function ee(t,n,e){var r,i,a;return function(){var o,u,l=e(this);if(null!=l)return(o=this.getAttribute(t))===(u=l+"")?null:o===r&&u===i?a:(i=u,a=n(r=o,l));this.removeAttribute(t)}}function re(t,n,e){var r,i,a;return function(){var o,u,l=e(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(u=l+"")?null:o===r&&u===i?a:(i=u,a=n(r=o,l));this.removeAttributeNS(t.space,t.local)}}function ie(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function ae(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function oe(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&ae(t,i)),e}return i._value=n,i}function ue(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&ie(t,i)),e}return i._value=n,i}function le(t,n){return function(){Wt(this,t).delay=+n.apply(this,arguments)}}function se(t,n){return n=+n,function(){Wt(this,t).delay=n}}function fe(t,n){return function(){Gt(this,t).duration=+n.apply(this,arguments)}}function ce(t,n){return n=+n,function(){Gt(this,t).duration=n}}function he(t,n){if("function"!=typeof n)throw new Error;return function(){Gt(this,t).ease=n}}function de(t,n,e){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||"start"===t}))}(n)?Wt:Gt;return function(){var o=a(this,t),u=o.on;u!==r&&(i=(r=u).copy()).on(n,e),o.on=i}}var pe=bt.prototype.constructor;function ge(t){return function(){this.style.removeProperty(t)}}function me(t,n,e){return function(r){this.style.setProperty(t,n.call(this,r),e)}}function ve(t,n,e){var r,i;function a(){var a=n.apply(this,arguments);return a!==i&&(r=(i=a)&&me(t,a,e)),r}return a._value=n,a}function be(t){return function(n){this.textContent=t.call(this,n)}}function ye(t){var n,e;function r(){var r=t.apply(this,arguments);return r!==e&&(n=(e=r)&&be(r)),n}return r._value=t,r}var we=0;function xe(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function _e(){return++we}var Me=bt.prototype;xe.prototype=function(t){return bt().transition(t)}.prototype={constructor:xe,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=a(t));for(var r=this._groups,i=r.length,o=new Array(i),u=0;u<i;++u)for(var l,s,f=r[u],c=f.length,h=o[u]=new Array(c),d=0;d<c;++d)(l=f[d])&&(s=t.call(l,l.__data__,d,f))&&("__data__"in l&&(s.__data__=l.__data__),h[d]=s,Vt(h[d],n,e,d,h,Ut(l,e)));return new xe(o,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=l(t));for(var r=this._groups,i=r.length,a=[],o=[],u=0;u<i;++u)for(var s,f=r[u],c=f.length,h=0;h<c;++h)if(s=f[h]){for(var d,p=t.call(s,s.__data__,h,f),g=Ut(s,e),m=0,v=p.length;m<v;++m)(d=p[m])&&Vt(d,n,e,m,p,g);a.push(p),o.push(s)}return new xe(a,o,n,e)},selectChild:Me.selectChild,selectChildren:Me.selectChildren,filter:function(t){"function"!=typeof t&&(t=s(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var a,o=n[i],u=o.length,l=r[i]=[],f=0;f<u;++f)(a=o[f])&&t.call(a,a.__data__,f,o)&&l.push(a);return new xe(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,a=Math.min(r,i),o=new Array(r),u=0;u<a;++u)for(var l,s=n[u],f=e[u],c=s.length,h=o[u]=new Array(c),d=0;d<c;++d)(l=s[d]||f[d])&&(h[d]=l);for(;u<r;++u)o[u]=n[u];return new xe(o,this._parents,this._name,this._id)},selection:function(){return new pe(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=_e(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,u=r[a],l=u.length,s=0;s<l;++s)if(o=u[s]){var f=Ut(o,n);Vt(o,t,e,s,u,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new xe(r,this._parents,t,e)},call:Me.call,nodes:Me.nodes,node:Me.node,size:Me.size,empty:Me.empty,each:Me.each,on:function(t,n){var e=this._id;return arguments.length<2?Ut(this.node(),e).on.on(t):this.each(de(e,t,n))},attr:function(t,n){var e=k(t),r="transform"===e?rn:Qn;return this.attrTween(t,"function"==typeof n?(e.local?re:ee)(e,r,un(this,"attr."+t,n)):null==n?(e.local?Zn:Kn)(e):(e.local?ne:te)(e,r,n))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;var r=k(t);return this.tween(e,(r.local?oe:ue)(r,n))},style:function(t,n,e){var r="transform"==(t+="")?en:Qn;return null==n?this.styleTween(t,function(t,n){var e,r,i;return function(){var a=$(this,t),o=(this.style.removeProperty(t),$(this,t));return a===o?null:a===e&&o===r?i:i=n(e=a,r=o)}}(t,r)).on("end.style."+t,ge(t)):"function"==typeof n?this.styleTween(t,function(t,n,e){var r,i,a;return function(){var o=$(this,t),u=e(this),l=u+"";return null==u&&(this.style.removeProperty(t),l=u=$(this,t)),o===l?null:o===r&&l===i?a:(i=l,a=n(r=o,u))}}(t,r,un(this,"style."+t,n))).each(function(t,n){var e,r,i,a,o="style."+n,u="end."+o;return function(){var l=Gt(this,t),s=l.on,f=null==l.value[o]?a||(a=ge(n)):void 0;s===e&&i===f||(r=(e=s).copy()).on(u,i=f),l.on=r}}(this._id,t)):this.styleTween(t,function(t,n,e){var r,i,a=e+"";return function(){var o=$(this,t);return o===a?null:o===r?i:i=n(r=o,e)}}(t,r,n),e).on("end.style."+t,null)},styleTween:function(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!=typeof n)throw new Error;return this.tween(r,ve(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var n=t(this);this.textContent=null==n?"":n}}(un(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;return this.tween(n,ye(t))},remove:function(){return this.on("end.remove",function(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}(this._id))},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r,i=Ut(this.node(),e).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==n?an:on)(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?le:se)(n,t)):Ut(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?fe:ce)(n,t)):Ut(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(he(n,t)):Ut(this.node(),n).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,n){return function(){var e=n.apply(this,arguments);if("function"!=typeof e)throw new Error;Gt(this,t).ease=e}}(this._id,t))},end:function(){var t,n,e=this,r=e._id,i=e.size();return new Promise((function(a,o){var u={value:o},l={value:function(){0==--i&&a()}};e.each((function(){var e=Gt(this,r),i=e.on;i!==t&&((n=(t=i).copy())._.cancel.push(u),n._.interrupt.push(u),n._.end.push(l)),e.on=n})),0===i&&a()}))},[Symbol.iterator]:Me[Symbol.iterator]};var Ae={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function ke(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}bt.prototype.interrupt=function(t){return this.each((function(){!function(t,n){var e,r,i,a=t.__transition,o=!0;if(a){for(i in n=null==n?null:n+"",a)(e=a[i]).name===n?(r=e.state>2&&e.state<5,e.state=6,e.timer.stop(),e.on.call(r?"interrupt":"cancel",t,t.__data__,e.index,e.group),delete a[i]):o=!1;o&&delete t.__transition}}(this,t)}))},bt.prototype.transition=function(t){var n,e;t instanceof xe?(n=t._id,t=t._name):(n=_e(),(e=Ae).time=$t(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,u=r[a],l=u.length,s=0;s<l;++s)(o=u[s])&&Vt(o,t,n,s,u,e||ke(o,n));return new xe(r,this._parents,t,n)};const{abs:Se,max:Ne,min:qe}=Math;function Ee(t){return{type:t}}function Ce(t){return"string"==typeof t?new mt([[document.querySelector(t)]],[document.documentElement]):new mt([[t]],gt)}function je(t,n){if(t=function(t){let n;for(;n=t.sourceEvent;)t=n;return t}(t),void 0===n&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(n.getScreenCTM().inverse())).x,r.y]}if(n.getBoundingClientRect){var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}}return[t.pageX,t.pageY]}["w","e"].map(Ee),["n","s"].map(Ee),["n","w","e","s","nw","ne","sw","se"].map(Ee);const Ie={passive:!1},Pe={capture:!0,passive:!1};function Te(t){t.stopImmediatePropagation()}function ze(t){t.preventDefault(),t.stopImmediatePropagation()}const $e=t=>()=>t;function Re(t,{sourceEvent:n,subject:e,target:r,identifier:i,active:a,x:o,y:u,dx:l,dy:s,dispatch:f}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:s,enumerable:!0,configurable:!0},_:{value:f}})}function De(t){return!t.ctrlKey&&!t.button}function Oe(){return this.parentNode}function Fe(t,n){return null==n?{x:t.x,y:t.y}:n}function Xe(){return navigator.maxTouchPoints||"ontouchstart"in this}Re.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Le=Math.sqrt(50),Be=Math.sqrt(10),He=Math.sqrt(2);function Ye(t,n,e){var r=(n-t)/Math.max(0,e),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=Le?10:a>=Be?5:a>=He?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=Le?10:a>=Be?5:a>=He?2:1)}function Ve(t,n){return null==t||null==n?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function We(t,n){return null==t||null==n?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function Ge(t){let n,e,r;function i(t,r,i=0,a=t.length){if(i<a){if(0!==n(r,r))return a;do{const n=i+a>>>1;e(t[n],r)<0?i=n+1:a=n}while(i<a)}return i}return 2!==t.length?(n=Ve,e=(n,e)=>Ve(t(n),e),r=(n,e)=>t(n)-e):(n=t===Ve||t===We?t:Ue,e=t,r=t),{left:i,center:function(t,n,e=0,a=t.length){const o=i(t,n,e,a-1);return o>e&&r(t[o-1],n)>-r(t[o],n)?o-1:o},right:function(t,r,i=0,a=t.length){if(i<a){if(0!==n(r,r))return a;do{const n=i+a>>>1;e(t[n],r)<=0?i=n+1:a=n}while(i<a)}return i}}}function Ue(){return 0}const Je=Ge(Ve),Qe=Je.right,Ke=(Je.left,Ge((function(t){return null===t?NaN:+t})).center,Qe);function Ze(t,n){var e,r=n?n.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(e=0;e<i;++e)a[e]=rr(t[e],n[e]);for(;e<r;++e)o[e]=n[e];return function(t){for(e=0;e<i;++e)o[e]=a[e](t);return o}}function tr(t,n){var e=new Date;return t=+t,n=+n,function(r){return e.setTime(t*(1-r)+n*r),e}}function nr(t,n){var e,r={},i={};for(e in null!==t&&"object"==typeof t||(t={}),null!==n&&"object"==typeof n||(n={}),n)e in t?r[e]=rr(t[e],n[e]):i[e]=n[e];return function(t){for(e in r)i[e]=r[e](t);return i}}function er(t,n){n||(n=[]);var e,r=t?Math.min(n.length,t.length):0,i=n.slice();return function(a){for(e=0;e<r;++e)i[e]=t[e]*(1-a)+n[e]*a;return i}}function rr(t,n){var e,r,i=typeof n;return null==n||"boolean"===i?Hn(n):("number"===i?Jt:"string"===i?(e=Sn(n))?(n=e,Vn):Jn:n instanceof Sn?Vn:n instanceof Date?tr:(r=n,!ArrayBuffer.isView(r)||r instanceof DataView?Array.isArray(n)?Ze:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?nr:Jt:er))(t,n)}function ir(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}function ar(t){return+t}var or=[0,1];function ur(t){return t}function lr(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:(e=isNaN(n)?NaN:.5,function(){return e});var e}function sr(t,n,e){var r=t[0],i=t[1],a=n[0],o=n[1];return i<r?(r=lr(i,r),a=e(o,a)):(r=lr(r,i),a=e(a,o)),function(t){return a(r(t))}}function fr(t,n,e){var r=Math.min(t.length,n.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++o<r;)i[o]=lr(t[o],t[o+1]),a[o]=e(n[o],n[o+1]);return function(n){var e=Ke(t,n,1,r)-1;return a[e](i[e](n))}}function cr(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function hr(){return function(){var t,n,e,r,i,a,o=or,u=or,l=rr,s=ur;function f(){var t,n,e,l=Math.min(o.length,u.length);return s!==ur&&(t=o[0],n=o[l-1],t>n&&(e=t,t=n,n=e),s=function(e){return Math.max(t,Math.min(n,e))}),r=l>2?fr:sr,i=a=null,c}function c(n){return null==n||isNaN(n=+n)?e:(i||(i=r(o.map(t),u,l)))(t(s(n)))}return c.invert=function(e){return s(n((a||(a=r(u,o.map(t),Jt)))(e)))},c.domain=function(t){return arguments.length?(o=Array.from(t,ar),f()):o.slice()},c.range=function(t){return arguments.length?(u=Array.from(t),f()):u.slice()},c.rangeRound=function(t){return u=Array.from(t),l=ir,f()},c.clamp=function(t){return arguments.length?(s=!!t||ur,f()):s!==ur},c.interpolate=function(t){return arguments.length?(l=t,f()):l},c.unknown=function(t){return arguments.length?(e=t,c):e},function(e,r){return t=e,n=r,f()}}()(ur,ur)}function dr(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}var pr,gr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function mr(t){if(!(n=gr.exec(t)))throw new Error("invalid format: "+t);var n;return new vr({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}function vr(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function br(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]}function yr(t){return(t=br(Math.abs(t)))?t[1]:NaN}function wr(t,n){var e=br(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}mr.prototype=vr.prototype,vr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const xr={"%":(t,n)=>(100*t).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>wr(100*t,n),r:wr,s:function(t,n){var e=br(t,n);if(!e)return t+"";var r=e[0],i=e[1],a=i-(pr=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+br(t,Math.max(0,n+a-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function _r(t){return t}var Mr,Ar,kr,Sr=Array.prototype.map,Nr=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function qr(t){var n=t.domain;return t.ticks=function(t){var e=n();return function(t,n,e){var r,i,a,o,u=-1;if(e=+e,(t=+t)==(n=+n)&&e>0)return[t];if((r=n<t)&&(i=t,t=n,n=i),0===(o=Ye(t,n,e))||!isFinite(o))return[];if(o>0){let e=Math.round(t/o),r=Math.round(n/o);for(e*o<t&&++e,r*o>n&&--r,a=new Array(i=r-e+1);++u<i;)a[u]=(e+u)*o}else{o=-o;let e=Math.round(t*o),r=Math.round(n*o);for(e/o<t&&++e,r/o>n&&--r,a=new Array(i=r-e+1);++u<i;)a[u]=(e+u)/o}return r&&a.reverse(),a}(e[0],e[e.length-1],null==t?10:t)},t.tickFormat=function(t,e){var r=n();return function(t,n,e,r){var i,a=function(t,n,e){var r=Math.abs(n-t)/Math.max(0,e),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=Le?i*=10:a>=Be?i*=5:a>=He&&(i*=2),n<t?-i:i}(t,n,e);switch((r=mr(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(n));return null!=r.precision||isNaN(i=function(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(yr(n)/3)))-yr(Math.abs(t)))}(a,o))||(r.precision=i),kr(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,yr(n)-yr(t))+1}(a,Math.max(Math.abs(t),Math.abs(n))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(t){return Math.max(0,-yr(Math.abs(t)))}(a))||(r.precision=i-2*("%"===r.type))}return Ar(r)}(r[0],r[r.length-1],null==t?10:t,e)},t.nice=function(e){null==e&&(e=10);var r,i,a=n(),o=0,u=a.length-1,l=a[o],s=a[u],f=10;for(s<l&&(i=l,l=s,s=i,i=o,o=u,u=i);f-- >0;){if((i=Ye(l,s,e))===r)return a[o]=l,a[u]=s,n(a);if(i>0)l=Math.floor(l/i)*i,s=Math.ceil(s/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,s=Math.floor(s*i)/i}r=i}return t},t}function Er(){var t=hr();return t.copy=function(){return cr(t,Er())},dr.apply(t,arguments),qr(t)}function Cr(t){for(var n=t.length/6|0,e=new Array(n),r=0;r<n;)e[r]="#"+t.slice(6*r,6*++r);return e}function jr(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}}Mr=function(t){var n,e,r=void 0===t.grouping||void 0===t.thousands?_r:(n=Sr.call(t.grouping,Number),e=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,u=n[0],l=0;i>0&&u>0&&(l+u+1>r&&(u=Math.max(1,r-l)),a.push(t.substring(i-=u,i+u)),!((l+=u+1)>r));)u=n[o=(o+1)%n.length];return a.reverse().join(e)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",u=void 0===t.numerals?_r:function(t){return function(n){return n.replace(/[0-9]/g,(function(n){return t[+n]}))}}(Sr.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",s=void 0===t.minus?"":t.minus+"",f=void 0===t.nan?"NaN":t.nan+"";function c(t){var n=(t=mr(t)).fill,e=t.align,c=t.sign,h=t.symbol,d=t.zero,p=t.width,g=t.comma,m=t.precision,v=t.trim,b=t.type;"n"===b?(g=!0,b="g"):xr[b]||(void 0===m&&(m=12),v=!0,b="g"),(d||"0"===n&&"="===e)&&(d=!0,n="0",e="=");var y="$"===h?i:"#"===h&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===h?a:/[%p]/.test(b)?l:"",x=xr[b],_=/[defgprs%]/.test(b);function M(t){var i,a,l,h=y,M=w;if("c"===b)M=x(t)+M,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?f:x(Math.abs(t),m),v&&(t=function(t){t:for(var n,e=t.length,r=1,i=-1;r<e;++r)switch(t[r]){case".":i=n=r;break;case"0":0===i&&(i=r),n=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(n+1):t}(t)),A&&0==+t&&"+"!==c&&(A=!1),h=(A?"("===c?c:s:"-"===c||"("===c?"":c)+h,M=("s"===b?Nr[8+pr/3]:"")+M+(A&&"("===c?")":""),_)for(i=-1,a=t.length;++i<a;)if(48>(l=t.charCodeAt(i))||l>57){M=(46===l?o+t.slice(i+1):t.slice(i))+M,t=t.slice(0,i);break}}g&&!d&&(t=r(t,1/0));var k=h.length+t.length+M.length,S=k<p?new Array(p-k+1).join(n):"";switch(g&&d&&(t=r(S+t,S.length?p-M.length:1/0),S=""),e){case"<":t=h+t+M+S;break;case"=":t=h+S+t+M;break;case"^":t=S.slice(0,k=S.length>>1)+h+t+M+S.slice(k);break;default:t=S+h+t+M}return u(t)}return m=void 0===m?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),M.toString=function(){return t+""},M}return{format:c,formatPrefix:function(t,n){var e=c(((t=mr(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(yr(n)/3))),i=Math.pow(10,-r),a=Nr[8+r/3];return function(t){return e(i*t)+a}}}}({thousands:",",grouping:[3],currency:["$",""]}),Ar=Mr.format,kr=Mr.formatPrefix;const Ir=jr(Cr("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));function Pr(t,n,e){this.k=t,this.x=n,this.y=e}function Tr(t){return Math.floor(Math.random()*t)}function zr(t,n,...e){let r=Array(t);for(let i=0;i<t;i++)r[i]=n(...e);return r}function $r(t){return Array(t).fill(0)}function Rr(t,n){let e=Array(t.length);for(let r=0;r<e.length;r++)e[r]=t[r]-n[r];return e}function Dr(t,n){let e=Array(t.length);for(let r=0;r<e.length;r++)e[r]=t[r]+n[r];return e}function Or(t,n){let e=0;for(let r=0;r<t.length;r++)e+=t[r]*n[r];return e}function Fr(t,n){let e=Array(t.length);for(let r=0;r<e.length;r++)e[r]=t[r]*n;return e}function Xr(t,n){return zr(t,$r,n)}function Lr(t,n,e){let r=n.length,i=n[0].length,a=e.length;for(let o=0;o<r;o++)for(let r=0;r<a;r++){let a=0;for(let t=0;t<i;t++)a+=n[o][t]*e[r][t];t[o][r]=a}}function Br(t,n){let e=zr(t.length,Array,t[0].length);for(let r=0;r<t.length;r++)for(let i=0;i<t[0].length;i++)e[r][i]=t[r][i]+n[r][i];return e}function Hr(t,n){return t.map((t=>t.map((t=>t*n))))}function Yr(t,n){for(let e=0;e<t.length;e++)for(let r=0;r<t[0].length;r++)t[e][r]*=n}function Vr(t,n){for(let e=0;e<t.length;e++)for(let r=0;r<t[0].length;r++)t[e][r]+=n[e][r]}function Wr(t){let n=zr(t[0].length,Array,t.length);for(let e=0;e<t.length;e++)for(let r=0;r<t[0].length;r++)n[r][e]=t[e][r];return n}function Gr(t,n){return t.hasOwnProperty(n)}function Ur(t){return((t=Math.max(0,Math.min(255,Math.round(t))))<16?"0":"")+t.toString(16)}function Jr(t,n,e,r,i){let a=t.length,o=t[0].length,u=Array(a),l=Xr(a,o),s=Tr(n.length),f=Tr(n.length);for(let i=0;i<5e3;i++){let c=Rr(n[(i+s)%n.length],n[(i+f)%n.length]);for(let n=0;n<a;n++)u[n]=Or(c,t[n]);let h=Math.pow(Or(u,u)+r*r,e-1);for(let t=0;t<a;t++)for(let n=0;n<o;n++)l[t][n]+=c[n]*u[t]*h}return Yr(l,-4e-4*i),l}function Qr(t,n,e,r,i){let a=t.length,o=t[0].length,u=Array(a),l=Xr(a,o);for(let i=0;i<n.length;i++){let s=n[i];for(let n=0;n<a;n++)u[n]=Or(s,t[n]);let f=Math.pow(Or(u,u)+r*r,e-1);for(let t=0;t<a;t++)for(let n=0;n<o;n++)l[t][n]+=s[n]*u[t]*f}return Yr(l,-2/n.length*i),l}jr(Cr("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),jr(Cr("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),jr(Cr("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Pr.prototype={constructor:Pr,scale:function(t){return 1===t?this:new Pr(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new Pr(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Pr(1,0,0),Pr.prototype;let Kr={ultralocal:(t,n)=>Jr(t,n,-1,.05,.01),local:(t,n)=>Jr(t,n,0,.01,.5),pca:(t,n)=>Jr(t,n,1,0,.5),outlier:(t,n)=>Jr(t,n,2,0,5),push:(t,n)=>Qr(t,n,.5,.01,.5),pull:(t,n)=>Qr(t,n,.5,.01,-.2)},Zr='~\n<div>~\n    <style>\n        /* Reset all host styling. */\n        :host {\n            all: initial;\n        }\n        \n        * { font-family: sans-serif; }\n        input { vertical-align: middle; }\n        input[type=checkbox] { vertical-align: baseline; }\n        \n        .box { \n            background: #eee;\n            display: inline-block; \n            padding: 0.25em 0.5em 0.25em 0.5em; \n            margin: 0.25em; \n            border-radius: 0.25em;\n            vertical-align: middle;\n        }\n        \n        button {\n            margin: 0.25em 0.25em 0.25em 0.25em;\n            padding: 0px;\n            vertical-align: middle;\n            height: 24px;\n            width: 24px;\n        }\n        \n        .infoBox {\n            visibility: hidden;\n            position: absolute;\n            left: 10px;\n            bottom: 0px;\n            padding: 1em;\n            background: #fff;\n            border: 1px solid black;\n            border-radius: 0.25em;\n        }\n        \n        .messageArea {\n            position: absolute;\n            white-space: pre;\n            text-align: right;\n            right: 3px;\n            bottom: 3px;\n            color: #888;\n        }\n        \n        .labelDiv {\n            white-space: nowrap;\n            position: absolute;\n            border-radius: 3px;\n            padding: 2px 5px 1px 0px;\n            cursor: grab;  \n            user-select: none;\n            font-size: 15px;\n        }\n        \n        .labelDiv input {\n            padding: 0px;\n            margin: 0px 5px 0px 0px;\n        }    \n    </style>~\n\n    <div style="position: relative" class=plotDiv>\n        <canvas class=canvas></canvas>\n        <div class=messageArea></div>\n        <div class=overlay style="position: absolute; left:0; top:0;"></div>\n        <div class=infoBox>\n            <div><b><a href="https://logarithmic.net/langevitour/">langevitour</a></b></div>\n            <div class=infoBoxInfo></div>\n            <div>Projection:</div>\n            <textarea class=infoBoxProj rows=5 cols=30 wrap=off onclick="this.select()"></textarea>\n            <div><br>State:</div>\n            <textarea class=infoBoxState rows=5 cols=30 wrap=on onfocus="this.setSelectionRange(0,this.value.length,\'backward\');" spellcheck=false></textarea>\n        </div>\n    </div>~\n\n    <div class=controlDiv>\n        <button class=fullscreenButton title="Full screen"\n            ><svg  width=20 height=20 version="1.1" viewBox="7 7 22 22" style="vertical-align: middle;">\n            <path d="M 10,16 l 2,0 l 0,-4 l 4,0 l 0,-2 L 10,10 l 0,6 l 0,0 z"></path>\n            <path d="M 20,10 l 0,2 l 4,0 l 0,4 l 2,0 L 26,10 l -6,0 l 0,0 z"></path>\n            <path d="M 24,24 l -4,0 l 0,2 L 26,26 l 0,-6 l -2,0 l 0,4 l 0,0 z"></path>\n            <path d="M 12,20 L 10,20 L 10,26 l 6,0 l 0,-2 l -4,0 l 0,-4 l 0,0 z"></path>\n            </svg>~\n        </button>~\n        \n        <button class=infoButton>\n            ?\n        </button>~\n        \n        <div class=box>~\n            Axes~\n            <input class=axesCheckbox type=checkbox checked>~\n        </div>~\n        \n        <div class=box>~\n            Damping\n            <input type=range min=-3 max=3 step=0.01 value=0 class=dampInput>~\n        </div>~\n        \n        <div class=box>~\n            Heat~\n            <input class=heatCheckbox type=checkbox checked>~\n            <input type=range min=-2 max=4 step=0.01 value=0 class=heatInput>~\n        </div>~\n        \n        <br/>~\n        \n        <div class=box>~\n            Guide\n            <select class=guideSelect value=none>\n                <optgroup label="Explore">\n                    <option value=none title="Look at completely random projections.">free</option>\n                </optgroup>\n                <optgroup label="Layout">\n                    <option value=ultralocal title="Try to ensure small things don\'t overlap. May be unstable.">ultralocal</option>\n                    <option value=local title="Try to ensure things don\'t overlap. A good default.">local</option>\n                    <option value=pca title="Equivalent to Principal Components Analysis.">PCA</option>\n                    <option value=outlier title="Find projections with some points very far from other points.">outlier</option>\n                </optgroup>\n                <optgroup label="Central force">\n                    <option value=push title="Push points away from the center.">push</option>\n                    <option value=pull title="Pull points towards the center.">pull</option>\n                </optgroup>\n            </select> \n            <input type=range min=-2 max=2 step=0.01 value=0 class=guideInput>~\n        </div>~\n        \n        <div class=box>~\n            Label attraction~\n            <input class=labelCheckbox type=checkbox checked>~\n            <input type=range min=-3 max=1 step=0.01 value=0 class=labelInput>~\n        </div>~\n    </div>~\n</div>~\n'.replace(/~\s*/g,"");class ti extends EventTarget{constructor(t,n,e){super(),this.width=1,this.height=1,this.originalWidth=1,this.originalHeight=1,this.size=1,this.pointSize=1,this.center=[],this.scale=[],this.X=[[],[]],this.n=0,this.m=0,this.colnames=[],this.permutor=[],this.unpermutor=[],this.rownames=[],this.group=[],this.levels=[],this.levelColors=[],this.lineFrom=[],this.lineTo=[],this.fills=[],this.selection=null,this.filter=null,this.axes=[],this.labelData=[],this.proj=[[],[]],this.vel=[[],[]],this.xScale=Er(),this.yScale=Er(),this.xScaleClamped=Er(),this.yScaleClamped=Er(),this.haveData=!1,this.frameScheduled=!1,this.lastTime=0,this.mouseInCheckbox=!1,this.dragging=!1,this.fps=[],this.computeMessage="",this.mousing=!1,this.mouseX=0,this.mouseY=0,this.xy=[[],[]],this.fillsFrame=[],this.pointActive=[],this.container=t;let r=document.createElement("div");this.container.appendChild(r),this.shadow=r.attachShadow({mode:"open"}),this.shadow.innerHTML=Zr,this.shadowChild=this.shadow.firstChild,this.canvas=this.get("canvas"),this.overlay=this.get("overlay"),this.container.langevitour=this,this.resize(n,e);let i=this.get("plotDiv");i.addEventListener("mouseover",(t=>{this.mousing=!0})),i.addEventListener("mouseout",(t=>{this.mousing=!1})),i.addEventListener("mousemove",(t=>{let n=i.getBoundingClientRect();this.mouseX=t.x-n.left,this.mouseY=t.y-n.top})),null==this.container.requestFullscreen&&(this.get("fullscreenButton").style.display="none"),this.get("fullscreenButton").addEventListener("click",(()=>{document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():this.shadowChild.requestFullscreen()})),this.shadowChild.addEventListener("fullscreenchange",(()=>{let t=this.shadowChild;if(document.fullscreenElement){this.originalWidth=this.width,this.originalHeight=this.height;let n=Math.max(0,t.offsetWidth-t.offsetHeight)/2;t.style.paddingLeft=n+"px",this.width=t.offsetWidth-n,this.height=t.offsetHeight,this.configure()}else t.style.paddingLeft="0px",this.width=this.originalWidth,this.height=this.originalHeight,this.configure()})),this.get("infoButton").addEventListener("click",(()=>{let t=this.get("infoBox");if("visible"!=t.style.visibility&&this.haveData){t.style.visibility="visible";let n="projection <- cbind(\n    c(";n+=this.proj.map((t=>t.map(((t,n)=>(t/this.scale[n]).toFixed(Math.ceil(Math.log10(Math.max(0,this.scale[n]))+4)))).join(","))).join("),\n    c("),n+="))\nprojected <- as.matrix(X) %*% projection",this.getInput("infoBoxProj").value=n,this.getInput("infoBoxState").value=JSON.stringify(this.getState(),null,4),this.get("infoBoxInfo").innerHTML=`<p>${this.X.length.toLocaleString("en-US")} points.</p>`}else t.style.visibility="hidden"}))}get(t){return this.shadowChild.getElementsByClassName(t)[0]}getInput(t){return this.get(t)}getString(t){return this.getInput(t).value}getNumber(t){return Number(this.getInput(t).value)}getChecked(t){return this.getInput(t).checked}renderValue(t){if(!t)return this.haveData=!1,void this.configure();this.haveData=!0,this.n=t.X.length,this.m=t.X[0].length,this.pointSize=null!=t.pointSize?t.pointSize:1;let n=t.axisColors||[];this.center=t.center||Array(this.m).fill(0),this.scale=t.scale||Array(this.m).fill(1),this.permutor=function(t){let n=Array(t).fill(0).map(((t,n)=>n));for(let t=n.length-1;t>0;t--){const e=Tr(t+1);[n[t],n[e]]=[n[e],n[t]]}return n}(this.n),this.unpermutor=Array(this.n);for(let t=0;t<this.n;t++)this.unpermutor[this.permutor[t]]=t;if(this.X=this.permutor.map((n=>t.X[n])),t.rownames&&0!=t.rownames.length){let n=t.rownames;this.rownames=this.permutor.map((t=>n[t]))}else this.rownames=[];if(this.colnames=t.colnames,this.lineFrom=(t.lineFrom||[]).map((t=>this.unpermutor[t])),this.lineTo=(t.lineTo||[]).map((t=>this.unpermutor[t])),this.axes=[],t.extraAxes&&t.extraAxesNames&&t.extraAxesCenter)for(let e=0;e<t.extraAxes[0].length;e++){let r=t.extraAxes.map((t=>t[e])),i=Math.sqrt(Or(r,r)),a=Fr(r,1/i);this.axes.push({name:t.extraAxesNames[e],unit:a,scale:i,center:t.extraAxesCenter[e],color:n[e+this.m],proj:[]})}for(let e=0;e<this.m;e++){let r=$r(this.m);r[e]=1,this.axes.push({name:t.colnames[e],center:this.center[e],scale:this.scale[e],unit:r,color:n[e],proj:[]})}for(let t=0;t<this.axes.length;t++)this.axes[t].proj=this.X.map((n=>Or(n,this.axes[t].unit)));this.levels=t.levels,this.group=this.permutor.map((n=>t.group[n]));let e=this.levels.length;this.levelColors=(t.levelColors||[]).slice();for(let t=this.levelColors.length;t<e;t++){let n=(t+1/3)/e,r=104,i=r*(1+Math.cos(n*Math.PI*2)),a=r*(1+Math.cos((n+1/3)*Math.PI*2)),o=r*(1+Math.cos((n+2/3)*Math.PI*2));this.levelColors[t]=Cn(i,a,o).formatHex()}let r=null==t.colorVariation?.3:t.colorVariation;this.fills=[];for(let t=0;t<this.n;t++){let n=Cn(this.levelColors[this.group[t]]),e=1+r*(t/this.n*2-1);n.r*=e,n.g*=e,n.b*=e,this.fills[t]=n.formatHex()}if(this.labelData=[],this.levels.length>1)for(let t=0;t<this.levels.length;t++){let n=$r(this.m);for(let e=0;e<this.n;e++)this.group[e]==t&&(n=Dr(n,this.X[e]));n=Fr(n,1/Math.sqrt(Or(n,n))),this.labelData.push({type:"level",index:t,label:this.levels[t],vec:n,color:this.levelColors[t],active:!0,x:2,y:0,halfWidth:0,halfHeight:0,selected:!1})}for(let t=0;t<this.axes.length;t++)this.labelData.push({type:"axis",index:t,label:this.axes[t].name,vec:this.axes[t].unit,color:this.axes[t].color||"#000000",active:!0,x:2,y:0,halfWidth:0,halfHeight:0,selected:!1});this.proj=Xr(2,this.m),this.proj[0][0]=1,this.proj[1][1]=1,this.vel=Xr(2,this.m),this.xy=Xr(2,this.n),this.fillsFrame=Array(this.n).fill(""),this.pointActive=Array(this.n).fill(!0),this.frameScheduled||(this.scheduleFrame(),this.frameScheduled=!0),this.configure(),t.state&&this.setState(t.state)}resize(t,n){document.fullscreenElement||(this.width=Math.max(200,t),this.height=Math.max(200,n),this.configure())}configure(){this.canvas.style.width=this.width+"px",this.overlay.style.width=this.width+"px";let t=this.get("controlDiv").offsetHeight+5;if(this.size=Math.max(100,Math.min(this.width-100,this.height-t)),this.canvas.style.height=this.size+"px",this.overlay.style.height=this.size+"px",!this.haveData){this.overlay.style.opacity="0";let t=this.canvas.getContext("2d");return t.scale(1,1),void t.clearRect(0,0,this.canvas.width,this.canvas.height)}this.xScale=Er().domain([-1,1]).range([2.5,this.size-2.5]),this.yScale=Er().domain([-1,1]).range([this.size-2.5,2.5]),this.xScaleClamped=this.xScale.copy().clamp(!0),this.yScaleClamped=this.yScale.copy().clamp(!0);let n=Ce(this.overlay);n.selectAll("*").remove(),this.mouseInCheckbox=!1;let e=this,r=n.selectAll("div").data(this.labelData).join((t=>{let n=t.append("div").classed("labelDiv",!0);return n.append("input").attr("type","checkbox").property("checked",(t=>t.active)).on("change",(function(t,n){n.active=this.checked,e.dispatchEvent(new Event("change"))})).on("mouseover",(()=>{this.mouseInCheckbox=!0})).on("mouseout",(()=>{this.mouseInCheckbox=!1})),n.append("span"),n}));function i(){let t=e.xScale.invert(e.width);for(let n of e.labelData)n.x=Math.max(-1,Math.min(t,n.x)),n.y=Math.max(-1,Math.min(1,n.y));r.style("left",(t=>e.xScale(t.x)-t.halfWidth+"px")).style("top",(t=>e.yScale(t.y)-t.halfHeight+"px")).style("background",(t=>t.selected?"#aaa":"#ddd"))}r.style("cursor","grab").on("mouseover",((t,n)=>{n.selected+=1,i()})).on("mouseout",((t,n)=>{n.selected-=1,i()})),r.select("span").text((t=>t.label)).style("color",(t=>t.color)),r.each((function(t){t.halfWidth=this.offsetWidth/2,t.halfHeight=this.offsetHeight/2})),function(){var t,n,e,r,i=De,a=Oe,o=Fe,u=Xe,l={},s=kt("start","drag","end"),f=0,c=0;function h(t){t.on("mousedown.drag",d).filter(u).on("touchstart.drag",m).on("touchmove.drag",v,Ie).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(o,u){if(!r&&i.call(this,o,u)){var l=y(this,a.call(this,o,u),o,u,"mouse");l&&(Ce(o.view).on("mousemove.drag",p,Pe).on("mouseup.drag",g,Pe),function(t){var n=t.document.documentElement,e=Ce(t).on("dragstart.drag",ze,Pe);"onselectstart"in n?e.on("selectstart.drag",ze,Pe):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}(o.view),Te(o),e=!1,t=o.clientX,n=o.clientY,l("start",o))}}function p(r){if(ze(r),!e){var i=r.clientX-t,a=r.clientY-n;e=i*i+a*a>c}l.mouse("drag",r)}function g(t){Ce(t.view).on("mousemove.drag mouseup.drag",null),function(t,n){var e=t.document.documentElement,r=Ce(t).on("dragstart.drag",null);n&&(r.on("click.drag",ze,Pe),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}(t.view,e),ze(t),l.mouse("end",t)}function m(t,n){if(i.call(this,t,n)){var e,r,o=t.changedTouches,u=a.call(this,t,n),l=o.length;for(e=0;e<l;++e)(r=y(this,u,t,n,o[e].identifier,o[e]))&&(Te(t),r("start",t,o[e]))}}function v(t){var n,e,r=t.changedTouches,i=r.length;for(n=0;n<i;++n)(e=l[r[n].identifier])&&(ze(t),e("drag",t,r[n]))}function b(t){var n,e,i=t.changedTouches,a=i.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),n=0;n<a;++n)(e=l[i[n].identifier])&&(Te(t),e("end",t,i[n]))}function y(t,n,e,r,i,a){var u,c,d,p=s.copy(),g=je(a||e,n);if(null!=(d=o.call(t,new Re("beforestart",{sourceEvent:e,target:h,identifier:i,active:f,x:g[0],y:g[1],dx:0,dy:0,dispatch:p}),r)))return u=d.x-g[0]||0,c=d.y-g[1]||0,function e(a,o,s){var m,v=g;switch(a){case"start":l[i]=e,m=f++;break;case"end":delete l[i],--f;case"drag":g=je(s||o,n),m=f}p.call(a,t,new Re(a,{sourceEvent:o,subject:d,target:h,identifier:i,active:m,x:g[0]+u,y:g[1]+c,dx:g[0]-v[0],dy:g[1]-v[1],dispatch:p}),r)}}return h.filter=function(t){return arguments.length?(i="function"==typeof t?t:$e(!!t),h):i},h.container=function(t){return arguments.length?(a="function"==typeof t?t:$e(t),h):a},h.subject=function(t){return arguments.length?(o="function"==typeof t?t:$e(t),h):o},h.touchable=function(t){return arguments.length?(u="function"==typeof t?t:$e(!!t),h):u},h.on=function(){var t=s.on.apply(s,arguments);return t===s?h:t},h.clickDistance=function(t){return arguments.length?(c=(t=+t)*t,h):Math.sqrt(c)},h}().subject((function(t,n){return{x:t.x,y:t.y}})).on("start",(function(t,n){e.mouseInCheckbox||(e.dragging=!0,this.style.cursor="grabbing",n.selected+=1)})).on("drag",(function(t,n){e.dragging&&(n.x=e.xScale.invert(t.x),n.y=e.yScale.invert(t.y),i())})).on("end",(function(t,n){e.dragging&&(e.dragging=!1,this.style.cursor="grab",n.selected-=1)}))(r);let a=Math.ceil(25*this.labelData.length/(this.size-40));for(let t=0;t<this.labelData.length;t++){let n=this.labelData[t];if(n.x<1)continue;let e=(t-t%a)/a;n.selected=!1,n.x=this.xScale.invert(this.size+10+n.halfWidth+t%a*(this.width-this.size-10)/a),n.y=this.yScale.invert(20+25*e)}i()}getState(){let t={};t.axesOn=this.getChecked("axesCheckbox"),t.heatOn=this.getChecked("heatCheckbox"),t.guideType=this.getString("guideSelect"),t.labelAttractionOn=this.getChecked("labelCheckbox"),t.damping=this.getNumber("dampInput"),t.heat=this.getNumber("heatInput"),t.guide=this.getNumber("guideInput"),t.labelAttraction=this.getNumber("labelInput"),t.labelInactive=[],t.labelPos={};for(let n of this.labelData)n.active||t.labelInactive.push(n.label),n.x<1&&(t.labelPos[n.label]=[n.x,n.y]);return t.projection=this.proj,this.selection?t.selection=this.unpermutor.map((t=>this.selection[t])):t.selection=null,this.filter?t.filter=this.unpermutor.map((t=>this.filter[t])):t.filter=null,t}setState(t){if("string"==typeof t&&(t=JSON.parse(t)),t){if(Gr(t,"axesOn")&&(this.getInput("axesCheckbox").checked=t.axesOn),Gr(t,"heatOn")&&(this.getInput("heatCheckbox").checked=t.heatOn),Gr(t,"pointRepulsionType")&&(this.getInput("guideSelect").value=t.pointRepulsionType),Gr(t,"guideType")&&(this.getInput("guideSelect").value=t.guideType),Gr(t,"labelAttractionOn")&&(this.getInput("labelCheckbox").checked=t.labelAttractionOn),Gr(t,"damping")&&(this.getInput("dampInput").value=t.damping),Gr(t,"heat")&&(this.getInput("heatInput").value=t.heat),Gr(t,"pointRepulsion")&&(this.getInput("guideInput").value=t.pointRepulsion),Gr(t,"guide")&&(this.getInput("guideInput").value=t.guide),Gr(t,"labelAttraction")&&(this.getInput("labelInput").value=t.labelAttraction),Gr(t,"labelInactive"))for(let n of this.labelData)n.active=!t.labelInactive.includes(n.label);if(Gr(t,"labelPos"))for(let n of this.labelData)Gr(t.labelPos,n.label)?(n.x=t.labelPos[n.label][0],n.y=t.labelPos[n.label][1]):n.x=1;Gr(t,"projection")&&(this.proj=Array.from(t.projection.map((t=>Array.from(t))))),Gr(t,"selection")&&(null===t.selection?this.selection=null:this.selection=this.permutor.map((n=>t.selection[n]))),Gr(t,"filter")&&(null===t.filter?this.filter=null:this.filter=this.permutor.map((n=>t.filter[n]))),this.configure()}}scheduleFrame(){window.requestAnimationFrame(this.doFrame.bind(this))}doFrame(t){if(!this.haveData)return void(this.frameScheduled=!1);let n=(t/=1e3)-this.lastTime;if(this.lastTime=t,null==this.X||!function(t){let n=t;for(;;){let t=window.getComputedStyle(n);if("0"===t.opacity||"none"===t.display||"visible"!==t.visibility)return!1;if(!n.parentElement)break;n=n.parentElement}let e=t.getBoundingClientRect();return e.top<window.innerHeight&&e.bottom>=0&&e.left<window.innerWidth&&e.right>=0}(this.container))return void window.setTimeout(this.scheduleFrame.bind(this),100);this.compute(n),this.fps.push(Math.round(1/n)),this.fps.length>100&&this.fps.shift(),this.get("messageArea").innerText=`${this.computeMessage}\n${Math.min(...this.fps)} to ${Math.max(...this.fps)} FPS`;let e=null,r=null,i=this.labelData.filter((t=>t.selected));i.length&&("axis"==i[0].type?e=i[0].index:r=i[0].index);let a=this.getChecked("axesCheckbox"),o=Array(this.levels.length).fill(!0);for(let t of this.labelData)"level"==t.type&&(o[t.index]=t.active);this.overlay.style.opacity=this.mousing?"1":"0";let u=window.devicePixelRatio;this.canvas.width=Math.floor(this.width*u),this.canvas.height=Math.floor(this.size*u);let l=this.canvas.getContext("2d");l.scale(u,u),l.clearRect(0,0,this.width,this.size);let s=this.xScale.range(),f=this.yScale.range();l.strokeStyle="#000",l.fillStyle="#fff",l.fillRect(s[0],f[0],s[1]-s[0],f[1]-f[0]),l.strokeRect(s[0],f[0],s[1]-s[0],f[1]-f[0]);let c=.75;if(l.strokeStyle="#ccc",a)for(let t=0;t<this.axes.length;t++){let n=Or(this.proj[0],this.axes[t].unit),e=Or(this.proj[1],this.axes[t].unit);l.beginPath(),l.moveTo(this.xScale(-.75*n),this.yScale(-.75*e)),l.lineTo(this.xScale(c*n),this.yScale(c*e)),l.stroke()}Lr(this.xy,this.proj,this.X);for(let t=0;t<this.lineFrom.length;t++){let n=this.lineFrom[t],e=this.lineTo[t];if(!this.pointActive[n]||!this.pointActive[e])continue;let r=Math.sqrt(Math.pow(this.xy[0][n]-this.xy[0][e],2)+Math.pow(this.xy[1][n]-this.xy[1][e],2));r=Math.max(1/4,Math.min(1,r)),l.strokeStyle="#000000"+Ur(128/(4*r)),l.beginPath(),l.moveTo(this.xScaleClamped(this.xy[0][n]),this.yScaleClamped(this.xy[1][n])),l.lineTo(this.xScaleClamped(this.xy[0][e]),this.yScaleClamped(this.xy[1][e])),l.stroke()}for(let t=0;t<this.n;t++)this.fillsFrame[t]=this.fills[t];if(this.selection)for(let t=0;t<this.n;t++)this.selection[t]||(this.fillsFrame[t]="#bbbbbb");if(null!==r&&o[r])for(let t=0;t<this.n;t++)this.group[t]!=i[0].index&&(this.fillsFrame[t]="#bbbbbb");if(null!==e)for(let t=0;t<this.n;t++){let n=this.axes[e].proj[t];n=Math.tanh(2*n),this.fillsFrame[t]=Ir(.5*n+.5)}let h=this.pointSize;for(let t=0;t<this.n;t++)this.pointActive[t]&&(l.fillStyle=this.fillsFrame[t],l.fillRect(this.xScaleClamped(this.xy[0][t])-h,this.yScaleClamped(this.xy[1][t])-h,2*h,2*h));if(a&&null!==e){let t=Or(this.proj[0],this.axes[e].unit),n=Or(this.proj[1],this.axes[e].unit),r=[Or(this.proj[1],this.axes[e].unit),-Or(this.proj[0],this.axes[e].unit)];r=Fr(r,.05/Math.max(1e-30,Math.sqrt(Or(r,r))));let i=new Map,a=this.size;for(let t=0;t<this.n;t++){if(!this.pointActive[t])continue;let n=this.axes[e].proj[t];i.set(Math.round(n*a)/a,this.fillsFrame[t])}for(let[e,a]of i){let i=[t*e,n*e],o=Dr(i,r),u=Dr(i,Fr(r,-1));l.strokeStyle=a,l.beginPath(),l.moveTo(this.xScaleClamped(o[0]),this.yScaleClamped(o[1])),l.lineTo(this.xScaleClamped(u[0]),this.yScaleClamped(u[1])),l.stroke()}}if(l.textAlign="center",l.textBaseline="middle",l.save(),l.lineJoin="round",l.lineWidth=5,this.mousing&&this.mouseX<this.size&&this.rownames.length){let t=[];for(let n=0;n<this.n;n++)t[n]={i:n,d2:Math.pow(this.xScaleClamped(this.xy[0][n])-this.mouseX,2)+Math.pow(this.yScaleClamped(this.xy[1][n])-this.mouseY,2)};t.sort(((t,n)=>t.d2-n.d2)),l.font="15px sans-serif",l.strokeStyle="#fff",l.fillStyle="#000";for(let n=Math.min(this.n,1)-1;n>=0;n--){let e=t[n].i,r=this.xScaleClamped(this.xy[0][e]),i=this.yScaleClamped(this.xy[1][e]);l.strokeText(this.rownames[e],r,i),l.fillText(this.rownames[e],r,i)}}if(a)for(let t=0;t<this.axes.length;t++){let n=Or(this.proj[0],this.axes[t].unit),r=Or(this.proj[1],this.axes[t].unit);if(this.axes[t].color)l.strokeStyle="#fff",l.fillStyle=this.axes[t].color;else{let i=n*n+r*r,a=t==e?"":Ur(2*i*355);l.strokeStyle="#ffffff"+a,l.fillStyle="#000000"+a}if(t===e){let e=Er().domain([this.axes[t].center-this.axes[t].scale*c,this.axes[t].center+this.axes[t].scale*c]).range([-.75,c]).ticks(5);l.font="12px sans-serif";for(let i of e){let e=(i-this.axes[t].center)/this.axes[t].scale;l.strokeText(`${i}`,this.xScale(e*n),this.yScale(e*r)),l.fillText(`${i}`,this.xScale(e*n),this.yScale(e*r))}}l.font="15px sans-serif",l.strokeText(this.axes[t].name,this.xScale(c*n),this.yScale(c*r)),l.fillText(this.axes[t].name,this.xScale(c*n),this.yScale(c*r))}if(l.restore(),l.textAlign="left",l.textBaseline="middle",l.font="15px sans-serif",!this.mousing)for(let t=0,n=0;t<this.levels.length;t++)o[t]&&(l.fillStyle=this.levelColors[t],l.fillText(this.levels[t],this.size+10,11+20*n),n++);window.setTimeout(this.scheduleFrame.bind(this),5)}compute(e){let r=.1*Math.pow(10,this.getNumber("dampInput")),i=.1*Math.pow(10,this.getNumber("heatInput")),a=1*Math.pow(10,this.getNumber("guideInput")),o=1*Math.pow(10,this.getNumber("labelInput")),u=this.getChecked("heatCheckbox"),l=this.getString("guideSelect"),s=this.getChecked("labelCheckbox"),f=Array(this.levels.length).fill(!0);for(let t of this.labelData)"level"==t.type&&(f[t.index]=t.active);for(let t=0;t<this.n;t++)this.pointActive[t]=f[this.group[t]];if(null!==this.filter)for(let t=0;t<this.n;t++)this.pointActive[t]=this.pointActive[t]&&this.filter[t];this.dragging&&s&&(r=Math.max(r,5*o));let c=Math.max(1e-6,Math.min(1,e));this.computeMessage="";let h=this.vel,d=this.proj,p=Math.exp(-c*r);if(Yr(h,p),u){let n=1-p*p,e=zr(d.length,zr,this.m,t.normal.sample,0,Math.sqrt(i*n));e=function(t,n){let e=[...t];for(let r=0;r<e.length;r++)for(let i=0;i<n.length;i++)e[r]=Rr(e[r],Fr(n[i],Or(t[r],n[i])));return e}(e,d),Vr(h,e)}if("none"!=l){let t=this.X.filter(((t,n)=>this.pointActive[n]));if(t.length){let n=Kr[l](d,t);Yr(n,-a),Vr(h,n)}}if(s)for(let t of this.labelData){let n=t.x,e=t.y;if(n<=-1||e<=-1||n>=1||e>=1)continue;if("level"==t.type&&!f[t.index])continue;let r=4*(n*n+e*e);h[0]=Dr(h[0],Fr(t.vec,n*r*o)),h[1]=Dr(h[1],Fr(t.vec,e*r*o))}let g=[];for(let t of this.labelData)"axis"!=t.type||t.active||g.push(this.axes[t.index].unit);let m=g.length>=this.m-1,v=!1;if(g.length&&!m){let t=Math.min(2,1/c),{u:e,v:r,q:i}=(0,n.SVD)(Wr(g)),a=Math.max(...i);e=Wr(e);for(let n=0;n<e.length;n++){if(i[n]<1e-6*a){v=!0;continue}let r=e[n];for(let n=0;n<2;n++)h[n]=Rr(h[n],Fr(r,Or(r,h[n])+t*Or(r,d[n])))}}m&&(this.computeMessage+="Error: too many axes removed"),v&&(this.computeMessage+="Note: reduntant axes removed");let b=Br(d,Hr(h,c)),{u:y,v:w,q:x}=(0,n.SVD)(Wr(b));Lr(b,w,y),this.vel=Hr(Br(b,Hr(d,-1)),1/c),this.proj=b}}})(),langevitour=r})();
//# sourceMappingURL=langevitour-pack.js.map